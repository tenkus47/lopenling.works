"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkteminusclient"] = self["webpackChunkteminusclient"] || []).push([["default-app_components_TextDetail_AnnotationControlsContainer_js"],{

/***/ "./app/components/TextDetail/AnnotationControlsContainer.js":
/*!******************************************************************!*\
  !*** ./app/components/TextDetail/AnnotationControlsContainer.js ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   \"mapStateToProps\": () => (/* binding */ mapStateToProps)\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/defineProperty */ \"./node_modules/@babel/runtime/helpers/esm/defineProperty.js\");\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ \"./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/esm/slicedToArray.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var react_redux__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! react-redux */ \"./node_modules/react-redux/es/index.js\");\n/* harmony import */ var redux_batched_actions__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! redux-batched-actions */ \"./node_modules/redux-batched-actions/lib/index.js\");\n/* harmony import */ var _AnnotationControls__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./AnnotationControls */ \"./app/components/TextDetail/AnnotationControls.js\");\n/* harmony import */ var lib_addTibetanShay__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! lib/addTibetanShay */ \"./app/lib/addTibetanShay.js\");\n/* harmony import */ var reducers__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! reducers */ \"./app/reducers/index.js\");\n/* harmony import */ var actions__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! actions */ \"./app/actions/index.js\");\n/* harmony import */ var lib_AnnotatedText__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! lib/AnnotatedText */ \"./app/lib/AnnotatedText.js\");\n/* harmony import */ var lib_Annotation__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! lib/Annotation */ \"./app/lib/Annotation.js\");\n/* harmony import */ var lib_User__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! lib/User */ \"./app/lib/User.js\");\n/* harmony import */ var lib_Witness__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! lib/Witness */ \"./app/lib/Witness.js\");\n/* harmony import */ var lib_TextSegment__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! lib/TextSegment */ \"./app/lib/TextSegment.js\");\n/* harmony import */ var lib_SplitText__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! lib/SplitText */ \"./app/lib/SplitText.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! lodash */ \"./node_modules/lodash/lodash.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_16___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_16__);\n/* harmony import */ var react_dom_server__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! react-dom/server */ \"./node_modules/react-dom/server.browser.js\");\n/* harmony import */ var lib_Question__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! lib/Question */ \"./app/lib/Question.js\");\n\n\n\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar TEMPORARY_ANNOTATION_ID = -3;\nvar BASE_NAME = \"Working\";\n\nvar getAnnotationsData = function getAnnotationsData(annotations, sources, workingSourceName, selectedText) {\n  var annotationsData = [];\n  var baseSources = sources.filter(function (source) {\n    return source.isWorking || source.isBase;\n  });\n  var baseSourceNames = baseSources.map(function (source) {\n    return source.name;\n  });\n\n  if (annotations) {\n    var annotationsById = {};\n\n    var _loop = function _loop(i) {\n      var annotation = annotations[i];\n      var id = annotation.content + annotation.start;\n\n      if (annotation.isTemporary) {\n        annotationsById[TEMPORARY_ANNOTATION_ID] = {\n          name: annotation.getSourceName(),\n          content: annotation.content,\n          id: annotation.uniqueId,\n          isTemporary: true,\n          annotation: annotation\n        };\n        baseSourceNames = baseSourceNames.filter(function (a) {\n          return a !== annotation.getSourceName();\n        });\n        id = TEMPORARY_ANNOTATION_ID;\n      } else if (annotationsById[id]) {\n        var existingAnnotation = annotationsById[id];\n        existingAnnotation.name += \" \" + (0,lib_addTibetanShay__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(annotation.getSourceName());\n        baseSourceNames = baseSourceNames.filter(function (a) {\n          return a !== annotation.getSourceName();\n        });\n      } else {\n        annotationsById[id] = {\n          name: (0,lib_addTibetanShay__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(annotation.getSourceName()),\n          content: annotation.content,\n          id: annotation.uniqueId,\n          userCreated: annotation.userCreated,\n          annotation: annotation\n        };\n        baseSourceNames = baseSourceNames.filter(function (a) {\n          return a !== annotation.getSourceName();\n        });\n      }\n\n      if (!annotation.userCreated && annotation.creatorWitness.isWorking) {\n        annotationsById[id].isWorking = true;\n      } else {\n        annotationsById[id].isWorking = false;\n      }\n    };\n\n    for (var i = 0; i < annotations.length; i++) {\n      _loop(i);\n    } // Make sure Working source is first\n\n\n    baseSourceNames.unshift(workingSourceName);\n    var Base = baseSourceNames;\n\n    if ((selectedText === null || selectedText === void 0 ? void 0 : selectedText.name) !== \"བྱང་ཆུབ་སེམས་དཔའི་སྤྱོད་པ་ལ་འཇུག་པ་བཞུགས་སོ།\") {\n      //Dominant only awailable for chojuk text\n      Base = baseSourceNames.filter(function (l) {\n        return l !== \"Dominant\";\n      });\n    }\n\n    annotationsData = Object.keys(annotationsById).reduce(function (arr, key) {\n      var annotationData = annotationsById[key];\n\n      if (annotationData.isWorking) {\n        annotationData.name = Base.reduce(function (prev, cur) {\n          return prev += \" \" + (0,lib_addTibetanShay__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(cur, \";\");\n        }, \"\");\n      }\n\n      arr.push(annotationData);\n      return arr;\n    }, []);\n  }\n\n  return annotationsData;\n};\n\nvar getAvailableAnnotations = function getAvailableAnnotations(annotatedText, activeAnnotation, temporaryAnnotation, annotationPositions) {\n  var availableAnnotations = [];\n\n  if (!temporaryAnnotation || activeAnnotation.naturalId !== temporaryAnnotation.naturalId) {\n    availableAnnotations.push(activeAnnotation);\n  }\n\n  if (temporaryAnnotation) {\n    availableAnnotations.push(temporaryAnnotation);\n  }\n\n  var _annotatedText$getPos = annotatedText.getPositionOfAnnotation(activeAnnotation),\n      _annotatedText$getPos2 = (0,_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(_annotatedText$getPos, 2),\n      start = _annotatedText$getPos2[0],\n      length = _annotatedText$getPos2[1];\n\n  if (!start) {\n    return availableAnnotations;\n  }\n\n  var end = start + length;\n  var possibleAnnotations = [];\n\n  if (activeAnnotation.isInsertion) {\n    var insertionAnnotations = annotationPositions[\"i\" + start];\n\n    if (insertionAnnotations) {\n      possibleAnnotations = possibleAnnotations.concat(insertionAnnotations);\n    }\n\n    var activeInsertionAnnotations = annotationPositions[String(start)];\n\n    if (activeInsertionAnnotations) {\n      possibleAnnotations = possibleAnnotations.concat(activeInsertionAnnotations);\n    }\n  } else {\n    // Only include annotations if they encompass the whole annotation\n    // i.e. not if activeAnnotation is a user annotation and combines\n    // annotated text with normal text.\n    var startAnnotations = annotationPositions[String(start)];\n    var endAnnotations = annotationPositions[String(end)];\n\n    if (startAnnotations) {\n      possibleAnnotations = startAnnotations;\n    }\n\n    if (endAnnotations) {\n      possibleAnnotations = possibleAnnotations.concat(endAnnotations);\n    }\n  }\n\n  for (var i = 0; i < possibleAnnotations.length; i++) {\n    var annotation = possibleAnnotations[i];\n\n    if (annotation.start === activeAnnotation.start && annotation.length === activeAnnotation.length) {\n      // If an annotation is being edited, there will be a temporary annotation\n      // with the same natural id. If so, don't show the orignal version.\n      //\n      // We use natualId, as it normalises the id regardless of the original's\n      // save state. e.g. Upon editing a witness variant, a new annotation will be\n      // created. If the user is offline, that will not have been saved via the\n      // API yet. The user could then edit this new annotation, creating a temporary\n      // annotation based upon it. While this is being edited, the user could come\n      // back online and the save operation will succeed. This will mean the id of\n      // the temporary annotation will be different to the original edit, but naturalId\n      // will be the same.\n      if (!temporaryAnnotation || annotation.naturalId !== temporaryAnnotation.naturalId) {\n        availableAnnotations.push(annotation);\n      }\n    } else if (!annotatedText.activeWitness.isWorking) {\n      if (annotation.type === lib_Annotation__WEBPACK_IMPORTED_MODULE_11__.ANNOTATION_TYPES.pageBreak || annotation.type === lib_Annotation__WEBPACK_IMPORTED_MODULE_11__.ANNOTATION_TYPES.lineBreak) {\n        availableAnnotations.push(annotation);\n      }\n    }\n  }\n\n  availableAnnotations = lodash__WEBPACK_IMPORTED_MODULE_16___default().uniqWith(availableAnnotations, function (a, b) {\n    return a.id === b.id;\n  });\n  return availableAnnotations;\n};\n\nvar getTemporaryAnnotation = function getTemporaryAnnotation(state, type, user, witness, start, length) {\n  var annotations = reducers__WEBPACK_IMPORTED_MODULE_8__.getTemporaryAnnotations(state, witness.id, start, length, type);\n\n  if (annotations.length > 0) {\n    return annotations[0];\n  } else {\n    return null;\n  }\n};\n\nvar mapStateToProps = function mapStateToProps(state, ownProps) {\n  var user = reducers__WEBPACK_IMPORTED_MODULE_8__.getUser(state);\n  var selectedText = reducers__WEBPACK_IMPORTED_MODULE_8__.getSelectedText(state);\n  var activeAnnotation = ownProps.activeAnnotation;\n  var inline = ownProps.inline;\n  var selectedWitness = reducers__WEBPACK_IMPORTED_MODULE_8__.getSelectedTextWitness(state);\n\n  if (!selectedWitness) {\n    if (selectedText) {\n      selectedWitness = reducers__WEBPACK_IMPORTED_MODULE_8__.getWorkingWitness(state, selectedText.id);\n    }\n  }\n\n  if (!activeAnnotation || !selectedWitness) {\n    return {\n      annotationsData: null,\n      activeAnnotation: null,\n      baseAnnotation: null,\n      availableAnnotations: null,\n      user: user,\n      temporaryAnnotation: null,\n      inline: null,\n      firstSelectedSegment: null,\n      splitTextRect: null,\n      selectedWitness: null\n    };\n  }\n\n  var temporaryVariant = getTemporaryAnnotation(state, lib_Annotation__WEBPACK_IMPORTED_MODULE_11__.ANNOTATION_TYPES.variant, user, selectedWitness, activeAnnotation.start, activeAnnotation.length);\n  var annotations = getAvailableAnnotations(ownProps.annotatedText, activeAnnotation, temporaryVariant, ownProps.annotationPositions);\n  var variants = annotations.filter(function (annotation) {\n    return annotation.type === lib_Annotation__WEBPACK_IMPORTED_MODULE_11__.ANNOTATION_TYPES.variant;\n  });\n  var sources = reducers__WEBPACK_IMPORTED_MODULE_8__.getSources(state);\n  var workingSourceName = reducers__WEBPACK_IMPORTED_MODULE_8__.getTranslation(state, \"annotation.workingEdition\", BASE_NAME);\n  var variantsData = getAnnotationsData(variants, sources, workingSourceName, selectedText);\n  var baseAnnotation = null;\n\n  if (activeAnnotation.id == lib_AnnotatedText__WEBPACK_IMPORTED_MODULE_10__.BASE_ANNOTATION_ID) {\n    baseAnnotation = activeAnnotation;\n  } else {\n    var _ownProps$annotatedTe = ownProps.annotatedText.getPositionOfAnnotation(activeAnnotation),\n        _ownProps$annotatedTe2 = (0,_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(_ownProps$annotatedTe, 2),\n        start = _ownProps$annotatedTe2[0],\n        length = _ownProps$annotatedTe2[1];\n\n    if (start === null || length === null) {\n      variantsData = null;\n    } else {\n      baseAnnotation = ownProps.annotatedText.getBaseAnnotation(start, length);\n      var baseAnnotationData = getAnnotationsData([baseAnnotation], sources, workingSourceName);\n      variantsData = [].concat((0,_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(baseAnnotationData), (0,_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(variantsData));\n    }\n  } // make sure temporary annotation is first, then user created, then base annotation\n\n\n  if (variantsData) {\n    variantsData.sort(function (a, b) {\n      if (a.isTemporary) {\n        return -1;\n      } else if (b.isTemporary) {\n        return 1;\n      } else if (a.userCreated) {\n        return -1;\n      } else if (b.userCreated) {\n        return 1;\n      } else if (a.annotation.id && b.annotation.id) {\n        return a.annotation.id - b.annotation.id;\n      } else {\n        return 1;\n      }\n    });\n  }\n\n  var notes = annotations.filter(function (annotation) {\n    return annotation.type === lib_Annotation__WEBPACK_IMPORTED_MODULE_11__.ANNOTATION_TYPES.note;\n  });\n  var temporaryNotes = reducers__WEBPACK_IMPORTED_MODULE_8__.getTemporaryAnnotations(state, selectedWitness.id, activeAnnotation.start, activeAnnotation.length, lib_Annotation__WEBPACK_IMPORTED_MODULE_11__.ANNOTATION_TYPES.note);\n  var questionAnnotations = annotations.filter(function (annotation) {\n    return annotation.type === lib_Annotation__WEBPACK_IMPORTED_MODULE_11__.ANNOTATION_TYPES.question;\n  });\n  var questionsData = {};\n\n  if (questionAnnotations.length > 0) {\n    for (var i = 0; i < questionAnnotations.length; i++) {\n      var question = questionAnnotations[i];\n      questionsData[question.uniqueId] = {};\n      var isLoading = reducers__WEBPACK_IMPORTED_MODULE_8__.questionIsLoading(state, question);\n      questionsData[question.uniqueId][\"loading\"] = isLoading;\n      var questions = reducers__WEBPACK_IMPORTED_MODULE_8__.getQuestions(state, question.uniqueId);\n      questionsData[question.uniqueId][\"questions\"] = questions;\n    }\n  }\n\n  var temporaryQuestions = reducers__WEBPACK_IMPORTED_MODULE_8__.getTemporaryAnnotations(state, selectedWitness.id, activeAnnotation.start, activeAnnotation.length, lib_Annotation__WEBPACK_IMPORTED_MODULE_11__.ANNOTATION_TYPES.question);\n  var questionQuote = null;\n\n  if (temporaryQuestions.length > 0) {\n    var firstQuestion = temporaryQuestions[0];\n\n    var _ownProps$annotatedTe3 = ownProps.annotatedText.getPositionOfAnnotation(firstQuestion),\n        _ownProps$annotatedTe4 = (0,_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(_ownProps$annotatedTe3, 2),\n        _start = _ownProps$annotatedTe4[0],\n        end = _ownProps$annotatedTe4[1];\n\n    if (_start) {\n      if (!end) {\n        end = _start + 1;\n      }\n\n      var _ownProps$annotatedTe5 = ownProps.annotatedText.segmentedText.extractTextAroundPosition(_start, end, [\"།\", \" \"]),\n          _ownProps$annotatedTe6 = (0,_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(_ownProps$annotatedTe5, 3),\n          startText = _ownProps$annotatedTe6[0],\n          mainText = _ownProps$annotatedTe6[1],\n          endText = _ownProps$annotatedTe6[2];\n\n      var linkUrl = document.location.href;\n      questionQuote = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default().createElement(\"blockquote\", null, startText, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default().createElement(\"a\", {\n        href: linkUrl\n      }, mainText), endText);\n    }\n  }\n\n  var fontSize = (0,reducers__WEBPACK_IMPORTED_MODULE_8__.getTextFontSize)(state);\n  return {\n    annotationsData: variantsData,\n    activeAnnotation: activeAnnotation,\n    baseAnnotation: baseAnnotation,\n    availableAnnotations: annotations,\n    user: user,\n    temporaryAnnotation: temporaryVariant,\n    inline: inline,\n    firstSelectedSegment: ownProps.firstSelectedSegment,\n    splitTextRect: ownProps.splitTextRect,\n    selectedWitness: selectedWitness,\n    notes: notes,\n    temporaryNotes: temporaryNotes,\n    questions: questionAnnotations,\n    temporaryQuestions: temporaryQuestions,\n    questionsData: questionsData,\n    questionQuote: questionQuote,\n    fontSize: fontSize\n  };\n};\n\nvar mergeProps = function mergeProps(stateProps, dispatchProps, ownProps) {\n  var dispatch = dispatchProps.dispatch;\n\n  if (stateProps.questions.length > 0) {\n    for (var i = 0; i < stateProps.questions.length; i++) {\n      var question = stateProps.questions[i];\n      var loadQuestionData = true;\n\n      if (stateProps.questionsData.hasOwnProperty(question.uniqueId)) {\n        if (stateProps.questionsData[question.uniqueId].questions.length > 0 || stateProps.questionsData[question.uniqueId].loading) {\n          loadQuestionData = false;\n        }\n      }\n\n      if (loadQuestionData) {\n        dispatch(new actions__WEBPACK_IMPORTED_MODULE_9__.loadQuestion(question));\n      }\n    }\n  }\n\n  var addBreak = function addBreak(breakType) {\n    var selectBreak = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    return function () {\n      var location = ownProps.activeAnnotation;\n      var breakAnnotation = new lib_Annotation__WEBPACK_IMPORTED_MODULE_11__[\"default\"](null, location.witness, location.end + 1, 0, null, breakType, stateProps.selectedWitness, stateProps.user);\n      var selectedWitnessData = reducers__WEBPACK_IMPORTED_MODULE_8__.dataFromWitness(stateProps.selectedWitness);\n      var actionsBatch = [];\n      actionsBatch.push(actions__WEBPACK_IMPORTED_MODULE_9__.createdAnnotation(breakAnnotation));\n      actionsBatch.push(actions__WEBPACK_IMPORTED_MODULE_9__.appliedAnnotation(breakAnnotation.uniqueId, selectedWitnessData));\n\n      if (selectBreak) {\n        actionsBatch.push(actions__WEBPACK_IMPORTED_MODULE_9__.changedActiveTextAnnotation(breakAnnotation));\n      } else {\n        actionsBatch.push(actions__WEBPACK_IMPORTED_MODULE_9__.changedActiveTextAnnotation(null));\n      }\n\n      dispatch((0,redux_batched_actions__WEBPACK_IMPORTED_MODULE_5__.batchActions)(actionsBatch));\n    };\n  };\n\n  var saveAnnotation = function saveAnnotation(selectedAnnotation, content) {\n    if (!selectedAnnotation.isTemporary) {\n      console.warn(\"Tried to save a non-temporary annotation: %o\", selectedAnnotation);\n      return;\n    }\n\n    var selectedWitness = stateProps.selectedWitness;\n    var selectedWitnessData = reducers__WEBPACK_IMPORTED_MODULE_8__.dataFromWitness(selectedWitness);\n    var newAnnotation = new lib_Annotation__WEBPACK_IMPORTED_MODULE_11__[\"default\"](selectedAnnotation.id, selectedAnnotation.witness, selectedAnnotation.start, selectedAnnotation.length, content, selectedAnnotation.type, selectedAnnotation.creatorWitness, stateProps.user, selectedAnnotation.uniqueId, selectedAnnotation.basedOn);\n    newAnnotation.isSaved = selectedAnnotation.isSaved;\n    var actionsBatch = [];\n    var action = null;\n\n    if (newAnnotation.isSaved) {\n      action = actions__WEBPACK_IMPORTED_MODULE_9__.updatedAnnotation;\n    } else {\n      action = actions__WEBPACK_IMPORTED_MODULE_9__.createdAnnotation;\n    }\n\n    actionsBatch.push(action(newAnnotation));\n    actionsBatch.push(actions__WEBPACK_IMPORTED_MODULE_9__.removedTemporaryAnnotation(selectedAnnotation)); // TODO: figure out what needs changing to handle note annotations\n\n    actionsBatch.push(actions__WEBPACK_IMPORTED_MODULE_9__.appliedAnnotation(newAnnotation.uniqueId, selectedWitnessData));\n\n    if (newAnnotation.type === lib_Annotation__WEBPACK_IMPORTED_MODULE_11__.ANNOTATION_TYPES.variant) {\n      actionsBatch.push(actions__WEBPACK_IMPORTED_MODULE_9__.changedActiveTextAnnotation(newAnnotation));\n    }\n\n    dispatch((0,redux_batched_actions__WEBPACK_IMPORTED_MODULE_5__.batchActions)(actionsBatch));\n  };\n\n  return _objectSpread(_objectSpread(_objectSpread({}, stateProps), ownProps), {}, {\n    closeAnnotation: function closeAnnotation() {\n      var activeAnnotation = stateProps.activeAnnotation;\n\n      if (activeAnnotation) {\n        var dismissTextAnnotation = actions__WEBPACK_IMPORTED_MODULE_9__.changedActiveTextAnnotation(null);\n        dispatch(dismissTextAnnotation);\n      }\n    },\n    didSelectAnnotation: function didSelectAnnotation(annotation) {\n      var selectedAnnotation = null;\n\n      if (annotation.id == lib_AnnotatedText__WEBPACK_IMPORTED_MODULE_10__.BASE_ANNOTATION_ID) {\n        selectedAnnotation = stateProps.baseAnnotation;\n      } else {\n        selectedAnnotation = lodash__WEBPACK_IMPORTED_MODULE_16___default().find(stateProps.availableAnnotations, function (value) {\n          return value.uniqueId == annotation.uniqueId;\n        }) || null;\n      }\n\n      var actionsBatch = [];\n      var selectedWitness = stateProps.selectedWitness; // let selectedWitnessData = reducers.getWitnessData(\n      //     state,\n      //     selectedWitness.id\n      // );\n\n      var selectedWitnessData = reducers__WEBPACK_IMPORTED_MODULE_8__.dataFromWitness(selectedWitness);\n\n      if (annotation.uniqueId != stateProps.activeAnnotation.uniqueId) {\n        if (selectedWitness.isWorking) {\n          if (annotation.id != lib_AnnotatedText__WEBPACK_IMPORTED_MODULE_10__.BASE_ANNOTATION_ID) {\n            actionsBatch.push(actions__WEBPACK_IMPORTED_MODULE_9__.appliedAnnotation(selectedAnnotation.uniqueId, selectedWitnessData));\n          }\n\n          if (stateProps.activeAnnotation.id != lib_AnnotatedText__WEBPACK_IMPORTED_MODULE_10__.BASE_ANNOTATION_ID) {\n            actionsBatch.push(actions__WEBPACK_IMPORTED_MODULE_9__.removedAppliedAnnotation(stateProps.activeAnnotation.uniqueId, selectedWitnessData));\n          }\n        } else {\n          if (stateProps.activeAnnotation.creatorWitness.id === selectedWitness.id) {\n            // Replacing a default annotation\n            // Currently selected annotation is a default\n            // annotation. So need to remove that then\n            // apply the newly selected annotation.\n            actionsBatch.push(actions__WEBPACK_IMPORTED_MODULE_9__.removedDefaultAnnotation(stateProps.activeAnnotation.uniqueId, selectedWitnessData));\n\n            if (selectedAnnotation.id !== lib_AnnotatedText__WEBPACK_IMPORTED_MODULE_10__.BASE_ANNOTATION_ID) {\n              actionsBatch.push(actions__WEBPACK_IMPORTED_MODULE_9__.appliedAnnotation(selectedAnnotation.uniqueId, selectedWitnessData));\n            }\n          } else {\n            if (selectedAnnotation.creatorWitness.id === selectedWitness.id) {\n              actionsBatch.push(actions__WEBPACK_IMPORTED_MODULE_9__.appliedDefaultAnnotation(selectedAnnotation.uniqueId, selectedWitnessData));\n            } else if (selectedAnnotation.id !== lib_AnnotatedText__WEBPACK_IMPORTED_MODULE_10__.BASE_ANNOTATION_ID) {\n              actionsBatch.push(actions__WEBPACK_IMPORTED_MODULE_9__.appliedAnnotation(selectedAnnotation.uniqueId, selectedWitnessData));\n            }\n\n            if (stateProps.activeAnnotation.id !== lib_AnnotatedText__WEBPACK_IMPORTED_MODULE_10__.BASE_ANNOTATION_ID) {\n              actionsBatch.push(actions__WEBPACK_IMPORTED_MODULE_9__.removedAppliedAnnotation(stateProps.activeAnnotation.uniqueId, selectedWitnessData));\n            }\n          }\n        }\n\n        actionsBatch.push(actions__WEBPACK_IMPORTED_MODULE_9__.changedActiveTextAnnotation(selectedAnnotation));\n        dispatch((0,redux_batched_actions__WEBPACK_IMPORTED_MODULE_5__.batchActions)(actionsBatch));\n      }\n    },\n    editAnnotation: function editAnnotation(selectedAnnotation) {\n      var basedOn = selectedAnnotation.isWorkingAnnotation || selectedAnnotation.userCreated || selectedAnnotation.id === lib_AnnotatedText__WEBPACK_IMPORTED_MODULE_10__.BASE_ANNOTATION_ID ? null : selectedAnnotation;\n      var temporaryAnnotation = new lib_Annotation__WEBPACK_IMPORTED_MODULE_11__.TemporaryAnnotation(basedOn, selectedAnnotation.witness, selectedAnnotation.start, selectedAnnotation.length, selectedAnnotation.content, selectedAnnotation.type, stateProps.selectedWitness, stateProps.user);\n\n      if (selectedAnnotation.userCreated) {\n        // user annotations are updated\n        temporaryAnnotation.uniqueId = selectedAnnotation.uniqueId;\n        temporaryAnnotation.isSaved = selectedAnnotation.isSaved;\n      }\n\n      dispatch(actions__WEBPACK_IMPORTED_MODULE_9__.addedTemporaryAnnotation(temporaryAnnotation, true));\n    },\n    saveAnnotation: saveAnnotation,\n    cancelEditAnnotation: function cancelEditAnnotation(selectedAnnotation) {\n      if (!selectedAnnotation.isTemporary) {\n        console.warn(\"Tried to call cancelEditAnnotation on a non-temporary annotation: %o\", selectedAnnotation);\n        return;\n      }\n\n      var cancelAction = actions__WEBPACK_IMPORTED_MODULE_9__.removedTemporaryAnnotation(selectedAnnotation);\n      dispatch(cancelAction);\n    },\n    deleteAnnotation: function deleteAnnotation(annotation) {\n      var selectedWitness = stateProps.selectedWitness;\n      var selectedWitnessData = reducers__WEBPACK_IMPORTED_MODULE_8__.dataFromWitness(selectedWitness);\n      var actionsBatch = [];\n\n      if (annotation.userCreated) {\n        var deleteAction = actions__WEBPACK_IMPORTED_MODULE_9__.deletedAnnotation(annotation, selectedWitness);\n        var removeAppliedAction = actions__WEBPACK_IMPORTED_MODULE_9__.removedAppliedAnnotation(annotation.uniqueId, selectedWitnessData);\n        actionsBatch = [deleteAction, removeAppliedAction];\n      } else {\n        // Assume this is a default annotation that was\n        // automatically imported from external data\n        var removeDefaultAnnotation = actions__WEBPACK_IMPORTED_MODULE_9__.removedDefaultAnnotation(annotation.uniqueId, selectedWitnessData);\n        actionsBatch = [removeDefaultAnnotation];\n      }\n\n      if (stateProps.activeAnnotation.uniqueId === annotation.uniqueId) {\n        actionsBatch.push(actions__WEBPACK_IMPORTED_MODULE_9__.changedActiveTextAnnotation(null));\n      }\n\n      dispatch((0,redux_batched_actions__WEBPACK_IMPORTED_MODULE_5__.batchActions)(actionsBatch));\n    },\n    addNote: function addNote() {\n      var activeAnnotation = ownProps.activeAnnotation;\n      var temporaryAnnotation = new lib_Annotation__WEBPACK_IMPORTED_MODULE_11__.TemporaryAnnotation(null, activeAnnotation.witness, activeAnnotation.start, activeAnnotation.length, \"\", lib_Annotation__WEBPACK_IMPORTED_MODULE_11__.ANNOTATION_TYPES.note, stateProps.selectedWitness, stateProps.user);\n      dispatch(actions__WEBPACK_IMPORTED_MODULE_9__.addedTemporaryAnnotation(temporaryAnnotation, true));\n    },\n    editNote: function editNote(note) {\n      var temporaryAnnotation = new lib_Annotation__WEBPACK_IMPORTED_MODULE_11__.TemporaryAnnotation(note, note.witness, note.start, note.length, note.content, lib_Annotation__WEBPACK_IMPORTED_MODULE_11__.ANNOTATION_TYPES.note, stateProps.selectedWitness, stateProps.user);\n      dispatch(actions__WEBPACK_IMPORTED_MODULE_9__.addedTemporaryAnnotation(temporaryAnnotation, true));\n    },\n    addPageBreak: addBreak(lib_Annotation__WEBPACK_IMPORTED_MODULE_11__.ANNOTATION_TYPES.pageBreak),\n    addLineBreak: addBreak(lib_Annotation__WEBPACK_IMPORTED_MODULE_11__.ANNOTATION_TYPES.lineBreak),\n    addQuestion: function addQuestion() {\n      var activeAnnotation = ownProps.activeAnnotation;\n      var temporaryAnnotation = new lib_Annotation__WEBPACK_IMPORTED_MODULE_11__.TemporaryAnnotation(null, activeAnnotation.witness, activeAnnotation.start, activeAnnotation.length, \"\", lib_Annotation__WEBPACK_IMPORTED_MODULE_11__.ANNOTATION_TYPES.question, stateProps.selectedWitness, stateProps.user);\n      dispatch(actions__WEBPACK_IMPORTED_MODULE_9__.addedTemporaryAnnotation(temporaryAnnotation, true));\n    },\n    saveQuestion: function saveQuestion(question, title, content) {\n      var _ownProps$annotatedTe7 = ownProps.annotatedText.getPositionOfAnnotation(question),\n          _ownProps$annotatedTe8 = (0,_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(_ownProps$annotatedTe7, 2),\n          start = _ownProps$annotatedTe8[0],\n          end = _ownProps$annotatedTe8[1];\n\n      var questionQuoteText = react_dom_server__WEBPACK_IMPORTED_MODULE_17__.renderToStaticMarkup(stateProps.questionQuote);\n      var questionText = questionQuoteText + content;\n      saveAnnotation(question, content);\n      var createdQuestionAction = actions__WEBPACK_IMPORTED_MODULE_9__.createdQuestion(question, title, questionText);\n      dispatch(createdQuestionAction);\n    }\n  });\n};\n\nvar AnnotationControlsContainer = (0,react_redux__WEBPACK_IMPORTED_MODULE_4__.connect)(mapStateToProps, null, mergeProps)(_AnnotationControls__WEBPACK_IMPORTED_MODULE_6__[\"default\"]);\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (AnnotationControlsContainer);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9hcHAvY29tcG9uZW50cy9UZXh0RGV0YWlsL0Fubm90YXRpb25Db250cm9sc0NvbnRhaW5lci5qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQSxJQUFNc0IsdUJBQXVCLEdBQUcsQ0FBQyxDQUFqQztBQUNBLElBQU1DLFNBQVMsR0FBRyxTQUFsQjs7QUFVQSxJQUFNQyxrQkFBa0IsR0FBRyxTQUFyQkEsa0JBQXFCLENBQ3ZCQyxXQUR1QixFQUV2QkMsT0FGdUIsRUFHdkJDLGlCQUh1QixFQUl2QkMsWUFKdUIsRUFLSjtFQUNuQixJQUFJQyxlQUFlLEdBQUcsRUFBdEI7RUFDQSxJQUFJQyxXQUFXLEdBQUdKLE9BQU8sQ0FBQ0ssTUFBUixDQUNkLFVBQUNDLE1BQUQ7SUFBQSxPQUFZQSxNQUFNLENBQUNDLFNBQVAsSUFBb0JELE1BQU0sQ0FBQ0UsTUFBdkM7RUFBQSxDQURjLENBQWxCO0VBR0EsSUFBSUMsZUFBZSxHQUFHTCxXQUFXLENBQUNNLEdBQVosQ0FBZ0IsVUFBQ0osTUFBRDtJQUFBLE9BQVlBLE1BQU0sQ0FBQ0ssSUFBbkI7RUFBQSxDQUFoQixDQUF0Qjs7RUFDQSxJQUFJWixXQUFKLEVBQWlCO0lBQ2IsSUFBSWEsZUFBZSxHQUFHLEVBQXRCOztJQURhLDJCQUVKQyxDQUZJO01BR1QsSUFBSUMsVUFBVSxHQUFHZixXQUFXLENBQUNjLENBQUQsQ0FBNUI7TUFDQSxJQUFJRSxFQUFFLEdBQUdELFVBQVUsQ0FBQ0UsT0FBWCxHQUFxQkYsVUFBVSxDQUFDRyxLQUF6Qzs7TUFDQSxJQUFJSCxVQUFVLENBQUNJLFdBQWYsRUFBNEI7UUFDeEJOLGVBQWUsQ0FBQ2hCLHVCQUFELENBQWYsR0FBMkM7VUFDdkNlLElBQUksRUFBRUcsVUFBVSxD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LGdFQUFKLENBQ3hCLElBRHdCLEVBRXhCdUQsZ0JBQWdCLENBQUN3QixPQUZPLEVBR3hCeEIsZ0JBQWdCLENBQUN2QixLQUhPLEVBSXhCdUIsZ0JBQWdCLENBQUNmLE1BSk8sRUFLeEIsRUFMd0IsRUFNeEJ6QyxzRUFOd0IsRUFPeEI4SCxVQUFVLENBQUN2QyxlQVBhLEVBUXhCdUMsVUFBVSxDQUFDL0MsSUFSYSxDQUE1QjtNQVdBaUQsUUFBUSxDQUNKbkksNkRBQUEsQ0FBaUM0RCxtQkFBakMsRUFBc0QsSUFBdEQsQ0FESSxDQUFSO0lBR0gsQ0FoUEw7SUFpUElzSCxZQUFZLEVBQUUsc0JBQ1ZyRSxRQURVLEVBRVZzRSxLQUZVLEVBR1ZoSixPQUhVLEVBSVQ7TUFDRCw2QkFDSW1ELFFBQVEsQ0FBQzVCLGFBQVQsQ0FBdUJNLHVCQUF2QixDQUErQzZDLFFBQS9DLENBREo7TUFBQTtNQUFBLElBQUt6RSxLQUFMO01BQUEsSUFBWTZCLEdBQVo7O01BR0EsSUFBTW1ILGlCQUFpQixHQUFHeEssbUVBQUEsQ0FDdEJxSCxVQUFVLENBQUNiLGFBRFcsQ0FBMUI7TUFHQSxJQUFJa0UsWUFBWSxHQUFHRixpQkFBaUIsR0FBR2pKLE9BQXZDO01BRUE4RyxjQUFjLENBQUNwQyxRQUFELEVBQVcxRSxPQUFYLENBQWQ7TUFDQSxJQUFNb0oscUJBQXFCLEdBQUd2TCxvREFBQSxDQUMxQjZHLFFBRDBCLEVBRTFCc0UsS0FGMEIsRUFHMUJHLFlBSDBCLENBQTlCO01BS0FuRCxRQUFRLENBQUNvRCxxQkFBRCxDQUFSO0lBQ0g7RUFyUUw7QUF1UUgsQ0E3WEQ7O0FBK1hBLElBQU1FLDJCQUEyQixHQUFHL0wsb0RBQU8sQ0FDdkMyRixlQUR1QyxFQUV2QyxJQUZ1QyxFQUd2QzJDLFVBSHVDLENBQVAsQ0FJbENuSSwyREFKa0MsQ0FBcEM7QUFNQSxpRUFBZTRMLDJCQUFmIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGVtaW51c2NsaWVudC8uL2FwcC9jb21wb25lbnRzL1RleHREZXRhaWwvQW5ub3RhdGlvbkNvbnRyb2xzQ29udGFpbmVyLmpzPzAxMGEiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQGZsb3dcclxuaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xyXG5pbXBvcnQgeyBjb25uZWN0LCB1c2VTdG9yZSB9IGZyb20gXCJyZWFjdC1yZWR1eFwiO1xyXG5pbXBvcnQgeyBiYXRjaEFjdGlvbnMgfSBmcm9tIFwicmVkdXgtYmF0Y2hlZC1hY3Rpb25zXCI7XHJcbmltcG9ydCBBbm5vdGF0aW9uQ29udHJvbHMgZnJvbSBcIi4vQW5ub3RhdGlvbkNvbnRyb2xzXCI7XHJcbmltcG9ydCB0eXBlIHsgUHJvcHMgYXMgQ29udHJvbHNQcm9wcyB9IGZyb20gXCIuL0Fubm90YXRpb25Db250cm9sc1wiO1xyXG5pbXBvcnQgYWRkVGliZXRhblNoYXkgZnJvbSBcImxpYi9hZGRUaWJldGFuU2hheVwiO1xyXG5pbXBvcnQgKiBhcyByZWR1Y2VycyBmcm9tIFwicmVkdWNlcnNcIjtcclxuaW1wb3J0IHR5cGUgeyBBcHBTdGF0ZSB9IGZyb20gXCJyZWR1Y2Vyc1wiO1xyXG5pbXBvcnQgKiBhcyBhY3Rpb25zIGZyb20gXCJhY3Rpb25zXCI7XHJcbmltcG9ydCB7IEJBU0VfQU5OT1RBVElPTl9JRCB9IGZyb20gXCJsaWIvQW5ub3RhdGVkVGV4dFwiO1xyXG5pbXBvcnQgQW5ub3RhdGlvbiwge1xyXG4gICAgQU5OT1RBVElPTl9UWVBFUyxcclxuICAgIFRlbXBvcmFyeUFubm90YXRpb24sXHJcbn0gZnJvbSBcImxpYi9Bbm5vdGF0aW9uXCI7XHJcbmltcG9ydCB0eXBlIHsgQW5ub3RhdGlvblVuaXF1ZUlkIH0gZnJvbSBcImxpYi9Bbm5vdGF0aW9uXCI7XHJcbmltcG9ydCBBbm5vdGF0ZWRUZXh0IGZyb20gXCJsaWIvQW5ub3RhdGVkVGV4dFwiO1xyXG5pbXBvcnQgVXNlciBmcm9tIFwibGliL1VzZXJcIjtcclxuaW1wb3J0IFdpdG5lc3MgZnJvbSBcImxpYi9XaXRuZXNzXCI7XHJcbmltcG9ydCBUZXh0U2VnbWVudCBmcm9tIFwibGliL1RleHRTZWdtZW50XCI7XHJcbmltcG9ydCBTcGxpdFRleHQgZnJvbSBcImxpYi9TcGxpdFRleHRcIjtcclxuaW1wb3J0IF8gZnJvbSBcImxvZGFzaFwiO1xyXG5pbXBvcnQgeyBjaGFuZ2VkQWN0aXZlVGV4dEFubm90YXRpb24gfSBmcm9tIFwiYWN0aW9uc1wiO1xyXG5pbXBvcnQgUmVhY3RET01TZXJ2ZXIgZnJvbSBcInJlYWN0LWRvbS9zZXJ2ZXJcIjtcclxuaW1wb3J0IFF1ZXN0aW9uIGZyb20gXCJsaWIvUXVlc3Rpb25cIjtcclxuaW1wb3J0IHR5cGUgeyBRdWVzdGlvbkRhdGEgfSBmcm9tIFwiLi9Bbm5vdGF0aW9uQ29udHJvbHNcIjtcclxuaW1wb3J0IHsgZ2V0VGV4dEZvbnRTaXplIH0gZnJvbSBcInJlZHVjZXJzXCI7XHJcblxyXG5jb25zdCBURU1QT1JBUllfQU5OT1RBVElPTl9JRCA9IC0zO1xyXG5jb25zdCBCQVNFX05BTUUgPSBcIldvcmtpbmdcIjtcclxuXHJcbnR5cGUgQW5ub3RhdGlvbkRhdGEgPSB7XHJcbiAgICBuYW1lOiBzdHJpbmcsXHJcbiAgICBjb250ZW50OiBzdHJpbmcsXHJcbiAgICBpZDogQW5ub3RhdGlvblVuaXF1ZUlkLFxyXG4gICAgaXNUZW1wb3Jhcnk6IGJvb2xlYW4sXHJcbiAgICBhbm5vdGF0aW9uOiBBbm5vdGF0aW9uLFxyXG4gICAgdXNlckNyZWF0ZWQ6IGJvb2xlYW4sXHJcbn07XHJcbmNvbnN0IGdldEFubm90YXRpb25zRGF0YSA9IChcclxuICAgIGFubm90YXRpb25zLFxyXG4gICAgc291cmNlcyxcclxuICAgIHdvcmtpbmdTb3VyY2VOYW1lLFxyXG4gICAgc2VsZWN0ZWRUZXh0XHJcbik6IEFubm90YXRpb25EYXRhW10gPT4ge1xyXG4gICAgbGV0IGFubm90YXRpb25zRGF0YSA9IFtdO1xyXG4gICAgbGV0IGJhc2VTb3VyY2VzID0gc291cmNlcy5maWx0ZXIoXHJcbiAgICAgICAgKHNvdXJjZSkgPT4gc291cmNlLmlzV29ya2luZyB8fCBzb3VyY2UuaXNCYXNlXHJcbiAgICApO1xyXG4gICAgbGV0IGJhc2VTb3VyY2VOYW1lcyA9IGJhc2VTb3VyY2VzLm1hcCgoc291cmNlKSA9PiBzb3VyY2UubmFtZSk7XHJcbiAgICBpZiAoYW5ub3RhdGlvbnMpIHtcclxuICAgICAgICBsZXQgYW5ub3RhdGlvbnNCeUlkID0ge307XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhbm5vdGF0aW9ucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBsZXQgYW5ub3RhdGlvbiA9IGFubm90YXRpb25zW2ldO1xyXG4gICAgICAgICAgICBsZXQgaWQgPSBhbm5vdGF0aW9uLmNvbnRlbnQgKyBhbm5vdGF0aW9uLnN0YXJ0O1xyXG4gICAgICAgICAgICBpZiAoYW5ub3RhdGlvbi5pc1RlbXBvcmFyeSkge1xyXG4gICAgICAgICAgICAgICAgYW5ub3RhdGlvbnNCeUlkW1RFTVBPUkFSWV9BTk5PVEFUSU9OX0lEXSA9IHtcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBhbm5vdGF0aW9uLmdldFNvdXJjZU5hbWUoKSxcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBhbm5vdGF0aW9uLmNvbnRlbnQsXHJcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGFubm90YXRpb24udW5pcXVlSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgaXNUZW1wb3Jhcnk6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgYW5ub3RhdGlvbjogYW5ub3RhdGlvbixcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBiYXNlU291cmNlTmFtZXMgPSBiYXNlU291cmNlTmFtZXMuZmlsdGVyKFxyXG4gICAgICAgICAgICAgICAgICAgIChhKSA9PiBhICE9PSBhbm5vdGF0aW9uLmdldFNvdXJjZU5hbWUoKVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIGlkID0gVEVNUE9SQVJZX0FOTk9UQVRJT05fSUQ7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoYW5ub3RhdGlvbnNCeUlkW2lkXSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IGV4aXN0aW5nQW5ub3RhdGlvbiA9IGFubm90YXRpb25zQnlJZFtpZF07XHJcbiAgICAgICAgICAgICAgICBleGlzdGluZ0Fubm90YXRpb24ubmFtZSArPVxyXG4gICAgICAgICAgICAgICAgICAgIFwiIFwiICsgYWRkVGliZXRhblNoYXkoYW5ub3RhdGlvbi5nZXRTb3VyY2VOYW1lKCkpO1xyXG4gICAgICAgICAgICAgICAgYmFzZVNvdXJjZU5hbWVzID0gYmFzZVNvdXJjZU5hbWVzLmZpbHRlcihcclxuICAgICAgICAgICAgICAgICAgICAoYSkgPT4gYSAhPT0gYW5ub3RhdGlvbi5nZXRTb3VyY2VOYW1lKClcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhbm5vdGF0aW9uc0J5SWRbaWRdID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IGFkZFRpYmV0YW5TaGF5KGFubm90YXRpb24uZ2V0U291cmNlTmFtZSgpKSxcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBhbm5vdGF0aW9uLmNvbnRlbnQsXHJcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGFubm90YXRpb24udW5pcXVlSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgdXNlckNyZWF0ZWQ6IGFubm90YXRpb24udXNlckNyZWF0ZWQsXHJcbiAgICAgICAgICAgICAgICAgICAgYW5ub3RhdGlvbjogYW5ub3RhdGlvbixcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBiYXNlU291cmNlTmFtZXMgPSBiYXNlU291cmNlTmFtZXMuZmlsdGVyKFxyXG4gICAgICAgICAgICAgICAgICAgIChhKSA9PiBhICE9PSBhbm5vdGF0aW9uLmdldFNvdXJjZU5hbWUoKVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICAhYW5ub3RhdGlvbi51c2VyQ3JlYXRlZCAmJlxyXG4gICAgICAgICAgICAgICAgYW5ub3RhdGlvbi5jcmVhdG9yV2l0bmVzcy5pc1dvcmtpbmdcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICBhbm5vdGF0aW9uc0J5SWRbaWRdLmlzV29ya2luZyA9IHRydWU7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhbm5vdGF0aW9uc0J5SWRbaWRdLmlzV29ya2luZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIE1ha2Ugc3VyZSBXb3JraW5nIHNvdXJjZSBpcyBmaXJzdFxyXG4gICAgICAgIGJhc2VTb3VyY2VOYW1lcy51bnNoaWZ0KHdvcmtpbmdTb3VyY2VOYW1lKTtcclxuICAgICAgICBsZXQgQmFzZSA9IGJhc2VTb3VyY2VOYW1lcztcclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgIHNlbGVjdGVkVGV4dD8ubmFtZSAhPT1cclxuICAgICAgICAgICAgXCLgvZbgvrHgvYTgvIvgvYbgvbTgvZbgvIvgvabgvbrgvZjgvabgvIvgvZHgvZTgvaDgvbLgvIvgvabgvqTgvrHgvbzgvZHgvIvgvZTgvIvgvaPgvIvgvaDgvYfgvbTgvYLgvIvgvZTgvIvgvZbgvZ7gvbTgvYLgvabgvIvgvabgvbzgvI1cIlxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgICAvL0RvbWluYW50IG9ubHkgYXdhaWxhYmxlIGZvciBjaG9qdWsgdGV4dFxyXG4gICAgICAgICAgICBCYXNlID0gYmFzZVNvdXJjZU5hbWVzLmZpbHRlcigobCkgPT4gbCAhPT0gXCJEb21pbmFudFwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGFubm90YXRpb25zRGF0YSA9IE9iamVjdC5rZXlzKGFubm90YXRpb25zQnlJZCkucmVkdWNlKChhcnIsIGtleSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBhbm5vdGF0aW9uRGF0YSA9IGFubm90YXRpb25zQnlJZFtrZXldO1xyXG5cclxuICAgICAgICAgICAgaWYgKGFubm90YXRpb25EYXRhLmlzV29ya2luZykge1xyXG4gICAgICAgICAgICAgICAgYW5ub3RhdGlvbkRhdGEubmFtZSA9IEJhc2UucmVkdWNlKFxyXG4gICAgICAgICAgICAgICAgICAgIChwcmV2LCBjdXIpID0+IChwcmV2ICs9IFwiIFwiICsgYWRkVGliZXRhblNoYXkoY3VyLCBcIjtcIikpLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiXCJcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYXJyLnB1c2goYW5ub3RhdGlvbkRhdGEpO1xyXG4gICAgICAgICAgICByZXR1cm4gYXJyO1xyXG4gICAgICAgIH0sIFtdKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gYW5ub3RhdGlvbnNEYXRhO1xyXG59O1xyXG5cclxuY29uc3QgZ2V0QXZhaWxhYmxlQW5ub3RhdGlvbnMgPSAoXHJcbiAgICBhbm5vdGF0ZWRUZXh0OiBBbm5vdGF0ZWRUZXh0LFxyXG4gICAgYWN0aXZlQW5ub3RhdGlvbjogQW5ub3RhdGlvbixcclxuICAgIHRlbXBvcmFyeUFubm90YXRpb246IFRlbXBvcmFyeUFubm90YXRpb24gfCBudWxsLFxyXG4gICAgYW5ub3RhdGlvblBvc2l0aW9uczogeyBbc3RyaW5nXTogQW5ub3RhdGlvbltdIH1cclxuKTogQW5ub3RhdGlvbltdID0+IHtcclxuICAgIGxldCBhdmFpbGFibGVBbm5vdGF0aW9ucyA9IFtdO1xyXG4gICAgaWYgKFxyXG4gICAgICAgICF0ZW1wb3JhcnlBbm5vdGF0aW9uIHx8XHJcbiAgICAgICAgYWN0aXZlQW5ub3RhdGlvbi5uYXR1cmFsSWQgIT09IHRlbXBvcmFyeUFubm90YXRpb24ubmF0dXJhbElkXHJcbiAgICApIHtcclxuICAgICAgICBhdmFpbGFibGVBbm5vdGF0aW9ucy5wdXNoKGFjdGl2ZUFubm90YXRpb24pO1xyXG4gICAgfVxyXG4gICAgaWYgKHRlbXBvcmFyeUFubm90YXRpb24pIHtcclxuICAgICAgICBhdmFpbGFibGVBbm5vdGF0aW9ucy5wdXNoKHRlbXBvcmFyeUFubm90YXRpb24pO1xyXG4gICAgfVxyXG4gICAgbGV0IFtzdGFydCwgbGVuZ3RoXSA9XHJcbiAgICAgICAgYW5ub3RhdGVkVGV4dC5nZXRQb3NpdGlvbk9mQW5ub3RhdGlvbihhY3RpdmVBbm5vdGF0aW9uKTtcclxuXHJcbiAgICBpZiAoIXN0YXJ0KSB7XHJcbiAgICAgICAgcmV0dXJuIGF2YWlsYWJsZUFubm90YXRpb25zO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBlbmQgPSBzdGFydCArIGxlbmd0aDtcclxuXHJcbiAgICBsZXQgcG9zc2libGVBbm5vdGF0aW9ucyA9IFtdO1xyXG5cclxuICAgIGlmIChhY3RpdmVBbm5vdGF0aW9uLmlzSW5zZXJ0aW9uKSB7XHJcbiAgICAgICAgY29uc3QgaW5zZXJ0aW9uQW5ub3RhdGlvbnMgPSBhbm5vdGF0aW9uUG9zaXRpb25zW1wiaVwiICsgc3RhcnRdO1xyXG4gICAgICAgIGlmIChpbnNlcnRpb25Bbm5vdGF0aW9ucykge1xyXG4gICAgICAgICAgICBwb3NzaWJsZUFubm90YXRpb25zID1cclxuICAgICAgICAgICAgICAgIHBvc3NpYmxlQW5ub3RhdGlvbnMuY29uY2F0KGluc2VydGlvbkFubm90YXRpb25zKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgYWN0aXZlSW5zZXJ0aW9uQW5ub3RhdGlvbnMgPSBhbm5vdGF0aW9uUG9zaXRpb25zW1N0cmluZyhzdGFydCldO1xyXG4gICAgICAgIGlmIChhY3RpdmVJbnNlcnRpb25Bbm5vdGF0aW9ucykge1xyXG4gICAgICAgICAgICBwb3NzaWJsZUFubm90YXRpb25zID0gcG9zc2libGVBbm5vdGF0aW9ucy5jb25jYXQoXHJcbiAgICAgICAgICAgICAgICBhY3RpdmVJbnNlcnRpb25Bbm5vdGF0aW9uc1xyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gT25seSBpbmNsdWRlIGFubm90YXRpb25zIGlmIHRoZXkgZW5jb21wYXNzIHRoZSB3aG9sZSBhbm5vdGF0aW9uXHJcbiAgICAgICAgLy8gaS5lLiBub3QgaWYgYWN0aXZlQW5ub3RhdGlvbiBpcyBhIHVzZXIgYW5ub3RhdGlvbiBhbmQgY29tYmluZXNcclxuICAgICAgICAvLyBhbm5vdGF0ZWQgdGV4dCB3aXRoIG5vcm1hbCB0ZXh0LlxyXG4gICAgICAgIGxldCBzdGFydEFubm90YXRpb25zID0gYW5ub3RhdGlvblBvc2l0aW9uc1tTdHJpbmcoc3RhcnQpXTtcclxuICAgICAgICBsZXQgZW5kQW5ub3RhdGlvbnMgPSBhbm5vdGF0aW9uUG9zaXRpb25zW1N0cmluZyhlbmQpXTtcclxuXHJcbiAgICAgICAgaWYgKHN0YXJ0QW5ub3RhdGlvbnMpIHtcclxuICAgICAgICAgICAgcG9zc2libGVBbm5vdGF0aW9ucyA9IHN0YXJ0QW5ub3RhdGlvbnM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChlbmRBbm5vdGF0aW9ucykge1xyXG4gICAgICAgICAgICBwb3NzaWJsZUFubm90YXRpb25zID0gcG9zc2libGVBbm5vdGF0aW9ucy5jb25jYXQoZW5kQW5ub3RhdGlvbnMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBvc3NpYmxlQW5ub3RhdGlvbnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBjb25zdCBhbm5vdGF0aW9uID0gcG9zc2libGVBbm5vdGF0aW9uc1tpXTtcclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgIGFubm90YXRpb24uc3RhcnQgPT09IGFjdGl2ZUFubm90YXRpb24uc3RhcnQgJiZcclxuICAgICAgICAgICAgYW5ub3RhdGlvbi5sZW5ndGggPT09IGFjdGl2ZUFubm90YXRpb24ubGVuZ3RoXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIC8vIElmIGFuIGFubm90YXRpb24gaXMgYmVpbmcgZWRpdGVkLCB0aGVyZSB3aWxsIGJlIGEgdGVtcG9yYXJ5IGFubm90YXRpb25cclxuICAgICAgICAgICAgLy8gd2l0aCB0aGUgc2FtZSBuYXR1cmFsIGlkLiBJZiBzbywgZG9uJ3Qgc2hvdyB0aGUgb3JpZ25hbCB2ZXJzaW9uLlxyXG4gICAgICAgICAgICAvL1xyXG4gICAgICAgICAgICAvLyBXZSB1c2UgbmF0dWFsSWQsIGFzIGl0IG5vcm1hbGlzZXMgdGhlIGlkIHJlZ2FyZGxlc3Mgb2YgdGhlIG9yaWdpbmFsJ3NcclxuICAgICAgICAgICAgLy8gc2F2ZSBzdGF0ZS4gZS5nLiBVcG9uIGVkaXRpbmcgYSB3aXRuZXNzIHZhcmlhbnQsIGEgbmV3IGFubm90YXRpb24gd2lsbCBiZVxyXG4gICAgICAgICAgICAvLyBjcmVhdGVkLiBJZiB0aGUgdXNlciBpcyBvZmZsaW5lLCB0aGF0IHdpbGwgbm90IGhhdmUgYmVlbiBzYXZlZCB2aWEgdGhlXHJcbiAgICAgICAgICAgIC8vIEFQSSB5ZXQuIFRoZSB1c2VyIGNvdWxkIHRoZW4gZWRpdCB0aGlzIG5ldyBhbm5vdGF0aW9uLCBjcmVhdGluZyBhIHRlbXBvcmFyeVxyXG4gICAgICAgICAgICAvLyBhbm5vdGF0aW9uIGJhc2VkIHVwb24gaXQuIFdoaWxlIHRoaXMgaXMgYmVpbmcgZWRpdGVkLCB0aGUgdXNlciBjb3VsZCBjb21lXHJcbiAgICAgICAgICAgIC8vIGJhY2sgb25saW5lIGFuZCB0aGUgc2F2ZSBvcGVyYXRpb24gd2lsbCBzdWNjZWVkLiBUaGlzIHdpbGwgbWVhbiB0aGUgaWQgb2ZcclxuICAgICAgICAgICAgLy8gdGhlIHRlbXBvcmFyeSBhbm5vdGF0aW9uIHdpbGwgYmUgZGlmZmVyZW50IHRvIHRoZSBvcmlnaW5hbCBlZGl0LCBidXQgbmF0dXJhbElkXHJcbiAgICAgICAgICAgIC8vIHdpbGwgYmUgdGhlIHNhbWUuXHJcbiAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICF0ZW1wb3JhcnlBbm5vdGF0aW9uIHx8XHJcbiAgICAgICAgICAgICAgICBhbm5vdGF0aW9uLm5hdHVyYWxJZCAhPT0gdGVtcG9yYXJ5QW5ub3RhdGlvbi5uYXR1cmFsSWRcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICBhdmFpbGFibGVBbm5vdGF0aW9ucy5wdXNoKGFubm90YXRpb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmICghYW5ub3RhdGVkVGV4dC5hY3RpdmVXaXRuZXNzLmlzV29ya2luZykge1xyXG4gICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICBhbm5vdGF0aW9uLnR5cGUgPT09IEFOTk9UQVRJT05fVFlQRVMucGFnZUJyZWFrIHx8XHJcbiAgICAgICAgICAgICAgICBhbm5vdGF0aW9uLnR5cGUgPT09IEFOTk9UQVRJT05fVFlQRVMubGluZUJyZWFrXHJcbiAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgYXZhaWxhYmxlQW5ub3RhdGlvbnMucHVzaChhbm5vdGF0aW9uKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBhdmFpbGFibGVBbm5vdGF0aW9ucyA9IF8udW5pcVdpdGgoXHJcbiAgICAgICAgYXZhaWxhYmxlQW5ub3RhdGlvbnMsXHJcbiAgICAgICAgKGEsIGIpID0+IGEuaWQgPT09IGIuaWRcclxuICAgICk7XHJcblxyXG4gICAgcmV0dXJuIGF2YWlsYWJsZUFubm90YXRpb25zO1xyXG59O1xyXG5cclxuY29uc3QgZ2V0VGVtcG9yYXJ5QW5ub3RhdGlvbiA9IChcclxuICAgIHN0YXRlOiBBcHBTdGF0ZSxcclxuICAgIHR5cGU6IHN0cmluZyxcclxuICAgIHVzZXI6IFVzZXIsXHJcbiAgICB3aXRuZXNzOiBXaXRuZXNzLFxyXG4gICAgc3RhcnQ6IG51bWJlcixcclxuICAgIGxlbmd0aDogbnVtYmVyXHJcbik6IFRlbXBvcmFyeUFubm90YXRpb24gfCBudWxsID0+IHtcclxuICAgIGNvbnN0IGFubm90YXRpb25zID0gcmVkdWNlcnMuZ2V0VGVtcG9yYXJ5QW5ub3RhdGlvbnMoXHJcbiAgICAgICAgc3RhdGUsXHJcbiAgICAgICAgd2l0bmVzcy5pZCxcclxuICAgICAgICBzdGFydCxcclxuICAgICAgICBsZW5ndGgsXHJcbiAgICAgICAgdHlwZVxyXG4gICAgKTtcclxuICAgIGlmIChhbm5vdGF0aW9ucy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgcmV0dXJuIGFubm90YXRpb25zWzBdO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxufTtcclxuXHJcbnR5cGUgU3RhdGVQcm9wcyA9IENvbnRyb2xzUHJvcHMgJiB7XHJcbiAgICBxdWVzdGlvbnNEYXRhOiB7IFthbm5vdGF0aW9uSWQ6IEFubm90YXRpb25VbmlxdWVJZF06IFF1ZXN0aW9uW10gfSxcclxufTtcclxuXHJcbi8vIFRoZXNlIGFyZSB0aGUgcHJvcHMgdGhhdCBhcmUgZXhwZWN0ZWQgdG8gYmUgc2V0IGFuZCBhdmFpbGFibGUgaW4gb3duUHJvcHNcclxudHlwZSBDb250YWluZXJQcm9wcyA9IHtcclxuICAgIGFubm90YXRpb25Qb3NpdGlvbnM6IHsgW3N0cmluZ106IEFubm90YXRpb25bXSB9LFxyXG4gICAgYW5ub3RhdGVkVGV4dDogQW5ub3RhdGVkVGV4dCxcclxuICAgIGFjdGl2ZUFubm90YXRpb246IEFubm90YXRpb24gfCBudWxsLFxyXG4gICAgaW5saW5lPzogYm9vbGVhbixcclxuICAgIGZpcnN0U2VsZWN0ZWRTZWdtZW50OiBUZXh0U2VnbWVudCxcclxuICAgIHNwbGl0VGV4dFJlY3Q6IENsaWVudFJlY3QgfCBudWxsLFxyXG4gICAgc3BsaXRUZXh0OiBTcGxpdFRleHQgfCBudWxsLFxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IG1hcFN0YXRlVG9Qcm9wcyA9IChzdGF0ZTogQXBwU3RhdGUsIG93blByb3BzOiBDb250YWluZXJQcm9wcykgPT4ge1xyXG4gICAgY29uc3QgdXNlciA9IHJlZHVjZXJzLmdldFVzZXIoc3RhdGUpO1xyXG4gICAgY29uc3Qgc2VsZWN0ZWRUZXh0ID0gcmVkdWNlcnMuZ2V0U2VsZWN0ZWRUZXh0KHN0YXRlKTtcclxuICAgIGNvbnN0IGFjdGl2ZUFubm90YXRpb24gPSBvd25Qcm9wcy5hY3RpdmVBbm5vdGF0aW9uO1xyXG4gICAgY29uc3QgaW5saW5lID0gb3duUHJvcHMuaW5saW5lO1xyXG4gICAgbGV0IHNlbGVjdGVkV2l0bmVzcyA9IHJlZHVjZXJzLmdldFNlbGVjdGVkVGV4dFdpdG5lc3Moc3RhdGUpO1xyXG4gICAgaWYgKCFzZWxlY3RlZFdpdG5lc3MpIHtcclxuICAgICAgICBpZiAoc2VsZWN0ZWRUZXh0KSB7XHJcbiAgICAgICAgICAgIHNlbGVjdGVkV2l0bmVzcyA9IHJlZHVjZXJzLmdldFdvcmtpbmdXaXRuZXNzKFxyXG4gICAgICAgICAgICAgICAgc3RhdGUsXHJcbiAgICAgICAgICAgICAgICBzZWxlY3RlZFRleHQuaWRcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCFhY3RpdmVBbm5vdGF0aW9uIHx8ICFzZWxlY3RlZFdpdG5lc3MpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBhbm5vdGF0aW9uc0RhdGE6IG51bGwsXHJcbiAgICAgICAgICAgIGFjdGl2ZUFubm90YXRpb246IG51bGwsXHJcbiAgICAgICAgICAgIGJhc2VBbm5vdGF0aW9uOiBudWxsLFxyXG4gICAgICAgICAgICBhdmFpbGFibGVBbm5vdGF0aW9uczogbnVsbCxcclxuICAgICAgICAgICAgdXNlcjogdXNlcixcclxuICAgICAgICAgICAgdGVtcG9yYXJ5QW5ub3RhdGlvbjogbnVsbCxcclxuICAgICAgICAgICAgaW5saW5lOiBudWxsLFxyXG4gICAgICAgICAgICBmaXJzdFNlbGVjdGVkU2VnbWVudDogbnVsbCxcclxuICAgICAgICAgICAgc3BsaXRUZXh0UmVjdDogbnVsbCxcclxuICAgICAgICAgICAgc2VsZWN0ZWRXaXRuZXNzOiBudWxsLFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgdGVtcG9yYXJ5VmFyaWFudCA9IGdldFRlbXBvcmFyeUFubm90YXRpb24oXHJcbiAgICAgICAgc3RhdGUsXHJcbiAgICAgICAgQU5OT1RBVElPTl9UWVBFUy52YXJpYW50LFxyXG4gICAgICAgIHVzZXIsXHJcbiAgICAgICAgc2VsZWN0ZWRXaXRuZXNzLFxyXG4gICAgICAgIGFjdGl2ZUFubm90YXRpb24uc3RhcnQsXHJcbiAgICAgICAgYWN0aXZlQW5ub3RhdGlvbi5sZW5ndGhcclxuICAgICk7XHJcblxyXG4gICAgY29uc3QgYW5ub3RhdGlvbnMgPSBnZXRBdmFpbGFibGVBbm5vdGF0aW9ucyhcclxuICAgICAgICBvd25Qcm9wcy5hbm5vdGF0ZWRUZXh0LFxyXG4gICAgICAgIGFjdGl2ZUFubm90YXRpb24sXHJcbiAgICAgICAgdGVtcG9yYXJ5VmFyaWFudCxcclxuICAgICAgICBvd25Qcm9wcy5hbm5vdGF0aW9uUG9zaXRpb25zXHJcbiAgICApO1xyXG4gICAgY29uc3QgdmFyaWFudHMgPSBhbm5vdGF0aW9ucy5maWx0ZXIoXHJcbiAgICAgICAgKGFubm90YXRpb246IEFubm90YXRpb24pID0+IGFubm90YXRpb24udHlwZSA9PT0gQU5OT1RBVElPTl9UWVBFUy52YXJpYW50XHJcbiAgICApO1xyXG4gICAgY29uc3Qgc291cmNlcyA9IHJlZHVjZXJzLmdldFNvdXJjZXMoc3RhdGUpO1xyXG4gICAgY29uc3Qgd29ya2luZ1NvdXJjZU5hbWUgPSByZWR1Y2Vycy5nZXRUcmFuc2xhdGlvbihcclxuICAgICAgICBzdGF0ZSxcclxuICAgICAgICBcImFubm90YXRpb24ud29ya2luZ0VkaXRpb25cIixcclxuICAgICAgICBCQVNFX05BTUVcclxuICAgICk7XHJcbiAgICBsZXQgdmFyaWFudHNEYXRhID0gZ2V0QW5ub3RhdGlvbnNEYXRhKFxyXG4gICAgICAgIHZhcmlhbnRzLFxyXG4gICAgICAgIHNvdXJjZXMsXHJcbiAgICAgICAgd29ya2luZ1NvdXJjZU5hbWUsXHJcbiAgICAgICAgc2VsZWN0ZWRUZXh0XHJcbiAgICApO1xyXG5cclxuICAgIGxldCBiYXNlQW5ub3RhdGlvbiA9IG51bGw7XHJcbiAgICBpZiAoYWN0aXZlQW5ub3RhdGlvbi5pZCA9PSBCQVNFX0FOTk9UQVRJT05fSUQpIHtcclxuICAgICAgICBiYXNlQW5ub3RhdGlvbiA9IGFjdGl2ZUFubm90YXRpb247XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnN0IFtzdGFydCwgbGVuZ3RoXSA9XHJcbiAgICAgICAgICAgIG93blByb3BzLmFubm90YXRlZFRleHQuZ2V0UG9zaXRpb25PZkFubm90YXRpb24oYWN0aXZlQW5ub3RhdGlvbik7XHJcbiAgICAgICAgaWYgKHN0YXJ0ID09PSBudWxsIHx8IGxlbmd0aCA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICB2YXJpYW50c0RhdGEgPSBudWxsO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGJhc2VBbm5vdGF0aW9uID0gb3duUHJvcHMuYW5ub3RhdGVkVGV4dC5nZXRCYXNlQW5ub3RhdGlvbihcclxuICAgICAgICAgICAgICAgIHN0YXJ0LFxyXG4gICAgICAgICAgICAgICAgbGVuZ3RoXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIGNvbnN0IGJhc2VBbm5vdGF0aW9uRGF0YSA9IGdldEFubm90YXRpb25zRGF0YShcclxuICAgICAgICAgICAgICAgIFtiYXNlQW5ub3RhdGlvbl0sXHJcbiAgICAgICAgICAgICAgICBzb3VyY2VzLFxyXG4gICAgICAgICAgICAgICAgd29ya2luZ1NvdXJjZU5hbWVcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgdmFyaWFudHNEYXRhID0gWy4uLmJhc2VBbm5vdGF0aW9uRGF0YSwgLi4udmFyaWFudHNEYXRhXTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gbWFrZSBzdXJlIHRlbXBvcmFyeSBhbm5vdGF0aW9uIGlzIGZpcnN0LCB0aGVuIHVzZXIgY3JlYXRlZCwgdGhlbiBiYXNlIGFubm90YXRpb25cclxuICAgIGlmICh2YXJpYW50c0RhdGEpIHtcclxuICAgICAgICB2YXJpYW50c0RhdGEuc29ydCgoYSwgYikgPT4ge1xyXG4gICAgICAgICAgICBpZiAoYS5pc1RlbXBvcmFyeSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGIuaXNUZW1wb3JhcnkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAxO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGEudXNlckNyZWF0ZWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAtMTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChiLnVzZXJDcmVhdGVkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChhLmFubm90YXRpb24uaWQgJiYgYi5hbm5vdGF0aW9uLmlkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYS5hbm5vdGF0aW9uLmlkIC0gYi5hbm5vdGF0aW9uLmlkO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBub3RlczogQXJyYXk8QW5ub3RhdGlvbj4gPSBhbm5vdGF0aW9ucy5maWx0ZXIoXHJcbiAgICAgICAgKGFubm90YXRpb246IEFubm90YXRpb24pID0+IGFubm90YXRpb24udHlwZSA9PT0gQU5OT1RBVElPTl9UWVBFUy5ub3RlXHJcbiAgICApO1xyXG5cclxuICAgIGNvbnN0IHRlbXBvcmFyeU5vdGVzID0gcmVkdWNlcnMuZ2V0VGVtcG9yYXJ5QW5ub3RhdGlvbnMoXHJcbiAgICAgICAgc3RhdGUsXHJcbiAgICAgICAgc2VsZWN0ZWRXaXRuZXNzLmlkLFxyXG4gICAgICAgIGFjdGl2ZUFubm90YXRpb24uc3RhcnQsXHJcbiAgICAgICAgYWN0aXZlQW5ub3RhdGlvbi5sZW5ndGgsXHJcbiAgICAgICAgQU5OT1RBVElPTl9UWVBFUy5ub3RlXHJcbiAgICApO1xyXG5cclxuICAgIGNvbnN0IHF1ZXN0aW9uQW5ub3RhdGlvbnM6IEFycmF5PEFubm90YXRpb24+ID0gYW5ub3RhdGlvbnMuZmlsdGVyKFxyXG4gICAgICAgIChhbm5vdGF0aW9uOiBBbm5vdGF0aW9uKTogYm9vbGVhbiA9PlxyXG4gICAgICAgICAgICBhbm5vdGF0aW9uLnR5cGUgPT09IEFOTk9UQVRJT05fVFlQRVMucXVlc3Rpb25cclxuICAgICk7XHJcbiAgICBsZXQgcXVlc3Rpb25zRGF0YSA9IHt9O1xyXG4gICAgaWYgKHF1ZXN0aW9uQW5ub3RhdGlvbnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcXVlc3Rpb25Bbm5vdGF0aW9ucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBjb25zdCBxdWVzdGlvbiA9IHF1ZXN0aW9uQW5ub3RhdGlvbnNbaV07XHJcbiAgICAgICAgICAgIHF1ZXN0aW9uc0RhdGFbcXVlc3Rpb24udW5pcXVlSWRdID0ge307XHJcbiAgICAgICAgICAgIGNvbnN0IGlzTG9hZGluZyA9IHJlZHVjZXJzLnF1ZXN0aW9uSXNMb2FkaW5nKHN0YXRlLCBxdWVzdGlvbik7XHJcbiAgICAgICAgICAgIHF1ZXN0aW9uc0RhdGFbcXVlc3Rpb24udW5pcXVlSWRdW1wibG9hZGluZ1wiXSA9IGlzTG9hZGluZztcclxuICAgICAgICAgICAgY29uc3QgcXVlc3Rpb25zID0gcmVkdWNlcnMuZ2V0UXVlc3Rpb25zKHN0YXRlLCBxdWVzdGlvbi51bmlxdWVJZCk7XHJcbiAgICAgICAgICAgIHF1ZXN0aW9uc0RhdGFbcXVlc3Rpb24udW5pcXVlSWRdW1wicXVlc3Rpb25zXCJdID0gcXVlc3Rpb25zO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB0ZW1wb3JhcnlRdWVzdGlvbnMgPSByZWR1Y2Vycy5nZXRUZW1wb3JhcnlBbm5vdGF0aW9ucyhcclxuICAgICAgICBzdGF0ZSxcclxuICAgICAgICBzZWxlY3RlZFdpdG5lc3MuaWQsXHJcbiAgICAgICAgYWN0aXZlQW5ub3RhdGlvbi5zdGFydCxcclxuICAgICAgICBhY3RpdmVBbm5vdGF0aW9uLmxlbmd0aCxcclxuICAgICAgICBBTk5PVEFUSU9OX1RZUEVTLnF1ZXN0aW9uXHJcbiAgICApO1xyXG5cclxuICAgIGxldCBxdWVzdGlvblF1b3RlID0gbnVsbDtcclxuICAgIGlmICh0ZW1wb3JhcnlRdWVzdGlvbnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIGNvbnN0IGZpcnN0UXVlc3Rpb24gPSB0ZW1wb3JhcnlRdWVzdGlvbnNbMF07XHJcblxyXG4gICAgICAgIGxldCBbc3RhcnQsIGVuZF0gPVxyXG4gICAgICAgICAgICBvd25Qcm9wcy5hbm5vdGF0ZWRUZXh0LmdldFBvc2l0aW9uT2ZBbm5vdGF0aW9uKGZpcnN0UXVlc3Rpb24pO1xyXG4gICAgICAgIGlmIChzdGFydCkge1xyXG4gICAgICAgICAgICBpZiAoIWVuZCkge1xyXG4gICAgICAgICAgICAgICAgZW5kID0gc3RhcnQgKyAxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IFtzdGFydFRleHQsIG1haW5UZXh0LCBlbmRUZXh0XSA9XHJcbiAgICAgICAgICAgICAgICBvd25Qcm9wcy5hbm5vdGF0ZWRUZXh0LnNlZ21lbnRlZFRleHQuZXh0cmFjdFRleHRBcm91bmRQb3NpdGlvbihcclxuICAgICAgICAgICAgICAgICAgICBzdGFydCxcclxuICAgICAgICAgICAgICAgICAgICBlbmQsXHJcbiAgICAgICAgICAgICAgICAgICAgW1wi4LyNXCIsIFwiIFwiXVxyXG4gICAgICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGxpbmtVcmwgPSBkb2N1bWVudC5sb2NhdGlvbi5ocmVmO1xyXG4gICAgICAgICAgICBxdWVzdGlvblF1b3RlID0gKFxyXG4gICAgICAgICAgICAgICAgPGJsb2NrcXVvdGU+XHJcbiAgICAgICAgICAgICAgICAgICAge3N0YXJ0VGV4dH1cclxuICAgICAgICAgICAgICAgICAgICA8YSBocmVmPXtsaW5rVXJsfT57bWFpblRleHR9PC9hPlxyXG4gICAgICAgICAgICAgICAgICAgIHtlbmRUZXh0fVxyXG4gICAgICAgICAgICAgICAgPC9ibG9ja3F1b3RlPlxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGxldCBmb250U2l6ZSA9IGdldFRleHRGb250U2l6ZShzdGF0ZSk7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBhbm5vdGF0aW9uc0RhdGE6IHZhcmlhbnRzRGF0YSxcclxuICAgICAgICBhY3RpdmVBbm5vdGF0aW9uOiBhY3RpdmVBbm5vdGF0aW9uLFxyXG4gICAgICAgIGJhc2VBbm5vdGF0aW9uOiBiYXNlQW5ub3RhdGlvbixcclxuICAgICAgICBhdmFpbGFibGVBbm5vdGF0aW9uczogYW5ub3RhdGlvbnMsXHJcbiAgICAgICAgdXNlcjogdXNlcixcclxuICAgICAgICB0ZW1wb3JhcnlBbm5vdGF0aW9uOiB0ZW1wb3JhcnlWYXJpYW50LFxyXG4gICAgICAgIGlubGluZTogaW5saW5lLFxyXG4gICAgICAgIGZpcnN0U2VsZWN0ZWRTZWdtZW50OiBvd25Qcm9wcy5maXJzdFNlbGVjdGVkU2VnbWVudCxcclxuICAgICAgICBzcGxpdFRleHRSZWN0OiBvd25Qcm9wcy5zcGxpdFRleHRSZWN0LFxyXG4gICAgICAgIHNlbGVjdGVkV2l0bmVzczogc2VsZWN0ZWRXaXRuZXNzLFxyXG4gICAgICAgIG5vdGVzOiBub3RlcyxcclxuICAgICAgICB0ZW1wb3JhcnlOb3RlczogdGVtcG9yYXJ5Tm90ZXMsXHJcbiAgICAgICAgcXVlc3Rpb25zOiBxdWVzdGlvbkFubm90YXRpb25zLFxyXG4gICAgICAgIHRlbXBvcmFyeVF1ZXN0aW9uczogdGVtcG9yYXJ5UXVlc3Rpb25zLFxyXG4gICAgICAgIHF1ZXN0aW9uc0RhdGE6IHF1ZXN0aW9uc0RhdGEsXHJcbiAgICAgICAgcXVlc3Rpb25RdW90ZTogcXVlc3Rpb25RdW90ZSxcclxuICAgICAgICBmb250U2l6ZSxcclxuICAgIH07XHJcbn07XHJcblxyXG5jb25zdCBtZXJnZVByb3BzID0gKHN0YXRlUHJvcHM6IFN0YXRlUHJvcHMsIGRpc3BhdGNoUHJvcHMsIG93blByb3BzKSA9PiB7XHJcbiAgICBjb25zdCB7IGRpc3BhdGNoIH0gPSBkaXNwYXRjaFByb3BzO1xyXG5cclxuICAgIGlmIChzdGF0ZVByb3BzLnF1ZXN0aW9ucy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdGF0ZVByb3BzLnF1ZXN0aW9ucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBjb25zdCBxdWVzdGlvbiA9IHN0YXRlUHJvcHMucXVlc3Rpb25zW2ldO1xyXG4gICAgICAgICAgICBsZXQgbG9hZFF1ZXN0aW9uRGF0YSA9IHRydWU7XHJcbiAgICAgICAgICAgIGlmIChzdGF0ZVByb3BzLnF1ZXN0aW9uc0RhdGEuaGFzT3duUHJvcGVydHkocXVlc3Rpb24udW5pcXVlSWQpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVQcm9wcy5xdWVzdGlvbnNEYXRhW3F1ZXN0aW9uLnVuaXF1ZUlkXS5xdWVzdGlvbnNcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmxlbmd0aCA+IDAgfHxcclxuICAgICAgICAgICAgICAgICAgICBzdGF0ZVByb3BzLnF1ZXN0aW9uc0RhdGFbcXVlc3Rpb24udW5pcXVlSWRdLmxvYWRpbmdcclxuICAgICAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxvYWRRdWVzdGlvbkRhdGEgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAobG9hZFF1ZXN0aW9uRGF0YSkge1xyXG4gICAgICAgICAgICAgICAgZGlzcGF0Y2gobmV3IGFjdGlvbnMubG9hZFF1ZXN0aW9uKHF1ZXN0aW9uKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgYWRkQnJlYWsgPSAoXHJcbiAgICAgICAgYnJlYWtUeXBlOiBzdHJpbmcsXHJcbiAgICAgICAgc2VsZWN0QnJlYWs6IGJvb2xlYW4gPSBmYWxzZVxyXG4gICAgKTogKCgpID0+IHZvaWQpID0+IHtcclxuICAgICAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBsb2NhdGlvbiA9IG93blByb3BzLmFjdGl2ZUFubm90YXRpb247XHJcblxyXG4gICAgICAgICAgICBjb25zdCBicmVha0Fubm90YXRpb24gPSBuZXcgQW5ub3RhdGlvbihcclxuICAgICAgICAgICAgICAgIG51bGwsXHJcbiAgICAgICAgICAgICAgICBsb2NhdGlvbi53aXRuZXNzLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb24uZW5kICsgMSxcclxuICAgICAgICAgICAgICAgIDAsXHJcbiAgICAgICAgICAgICAgICBudWxsLFxyXG4gICAgICAgICAgICAgICAgYnJlYWtUeXBlLFxyXG4gICAgICAgICAgICAgICAgc3RhdGVQcm9wcy5zZWxlY3RlZFdpdG5lc3MsXHJcbiAgICAgICAgICAgICAgICBzdGF0ZVByb3BzLnVzZXJcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgbGV0IHNlbGVjdGVkV2l0bmVzc0RhdGEgPSByZWR1Y2Vycy5kYXRhRnJvbVdpdG5lc3MoXHJcbiAgICAgICAgICAgICAgICBzdGF0ZVByb3BzLnNlbGVjdGVkV2l0bmVzc1xyXG4gICAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgICAgbGV0IGFjdGlvbnNCYXRjaCA9IFtdO1xyXG5cclxuICAgICAgICAgICAgYWN0aW9uc0JhdGNoLnB1c2goYWN0aW9ucy5jcmVhdGVkQW5ub3RhdGlvbihicmVha0Fubm90YXRpb24pKTtcclxuICAgICAgICAgICAgYWN0aW9uc0JhdGNoLnB1c2goXHJcbiAgICAgICAgICAgICAgICBhY3Rpb25zLmFwcGxpZWRBbm5vdGF0aW9uKFxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrQW5ub3RhdGlvbi51bmlxdWVJZCxcclxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZFdpdG5lc3NEYXRhXHJcbiAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIGlmIChzZWxlY3RCcmVhaykge1xyXG4gICAgICAgICAgICAgICAgYWN0aW9uc0JhdGNoLnB1c2goXHJcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9ucy5jaGFuZ2VkQWN0aXZlVGV4dEFubm90YXRpb24oYnJlYWtBbm5vdGF0aW9uKVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGFjdGlvbnNCYXRjaC5wdXNoKGFjdGlvbnMuY2hhbmdlZEFjdGl2ZVRleHRBbm5vdGF0aW9uKG51bGwpKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZGlzcGF0Y2goYmF0Y2hBY3Rpb25zKGFjdGlvbnNCYXRjaCkpO1xyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IHNhdmVBbm5vdGF0aW9uID0gKFxyXG4gICAgICAgIHNlbGVjdGVkQW5ub3RhdGlvbjogVGVtcG9yYXJ5QW5ub3RhdGlvbixcclxuICAgICAgICBjb250ZW50OiBzdHJpbmdcclxuICAgICkgPT4ge1xyXG4gICAgICAgIGlmICghc2VsZWN0ZWRBbm5vdGF0aW9uLmlzVGVtcG9yYXJ5KSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihcclxuICAgICAgICAgICAgICAgIFwiVHJpZWQgdG8gc2F2ZSBhIG5vbi10ZW1wb3JhcnkgYW5ub3RhdGlvbjogJW9cIixcclxuICAgICAgICAgICAgICAgIHNlbGVjdGVkQW5ub3RhdGlvblxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgc2VsZWN0ZWRXaXRuZXNzID0gc3RhdGVQcm9wcy5zZWxlY3RlZFdpdG5lc3M7XHJcbiAgICAgICAgbGV0IHNlbGVjdGVkV2l0bmVzc0RhdGEgPSByZWR1Y2Vycy5kYXRhRnJvbVdpdG5lc3Moc2VsZWN0ZWRXaXRuZXNzKTtcclxuXHJcbiAgICAgICAgY29uc3QgbmV3QW5ub3RhdGlvbiA9IG5ldyBBbm5vdGF0aW9uKFxyXG4gICAgICAgICAgICBzZWxlY3RlZEFubm90YXRpb24uaWQsXHJcbiAgICAgICAgICAgIHNlbGVjdGVkQW5ub3RhdGlvbi53aXRuZXNzLFxyXG4gICAgICAgICAgICBzZWxlY3RlZEFubm90YXRpb24uc3RhcnQsXHJcbiAgICAgICAgICAgIHNlbGVjdGVkQW5ub3RhdGlvbi5sZW5ndGgsXHJcbiAgICAgICAgICAgIGNvbnRlbnQsXHJcbiAgICAgICAgICAgIHNlbGVjdGVkQW5ub3RhdGlvbi50eXBlLFxyXG4gICAgICAgICAgICBzZWxlY3RlZEFubm90YXRpb24uY3JlYXRvcldpdG5lc3MsXHJcbiAgICAgICAgICAgIHN0YXRlUHJvcHMudXNlcixcclxuICAgICAgICAgICAgc2VsZWN0ZWRBbm5vdGF0aW9uLnVuaXF1ZUlkLFxyXG4gICAgICAgICAgICBzZWxlY3RlZEFubm90YXRpb24uYmFzZWRPblxyXG4gICAgICAgICk7XHJcbiAgICAgICAgbmV3QW5ub3RhdGlvbi5pc1NhdmVkID0gc2VsZWN0ZWRBbm5vdGF0aW9uLmlzU2F2ZWQ7XHJcbiAgICAgICAgbGV0IGFjdGlvbnNCYXRjaCA9IFtdO1xyXG4gICAgICAgIGxldCBhY3Rpb24gPSBudWxsO1xyXG4gICAgICAgIGlmIChuZXdBbm5vdGF0aW9uLmlzU2F2ZWQpIHtcclxuICAgICAgICAgICAgYWN0aW9uID0gYWN0aW9ucy51cGRhdGVkQW5ub3RhdGlvbjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBhY3Rpb24gPSBhY3Rpb25zLmNyZWF0ZWRBbm5vdGF0aW9uO1xyXG4gICAgICAgIH1cclxuICAgICAgICBhY3Rpb25zQmF0Y2gucHVzaChhY3Rpb24obmV3QW5ub3RhdGlvbikpO1xyXG4gICAgICAgIGFjdGlvbnNCYXRjaC5wdXNoKFxyXG4gICAgICAgICAgICBhY3Rpb25zLnJlbW92ZWRUZW1wb3JhcnlBbm5vdGF0aW9uKHNlbGVjdGVkQW5ub3RhdGlvbilcclxuICAgICAgICApO1xyXG4gICAgICAgIC8vIFRPRE86IGZpZ3VyZSBvdXQgd2hhdCBuZWVkcyBjaGFuZ2luZyB0byBoYW5kbGUgbm90ZSBhbm5vdGF0aW9uc1xyXG4gICAgICAgIGFjdGlvbnNCYXRjaC5wdXNoKFxyXG4gICAgICAgICAgICBhY3Rpb25zLmFwcGxpZWRBbm5vdGF0aW9uKFxyXG4gICAgICAgICAgICAgICAgbmV3QW5ub3RhdGlvbi51bmlxdWVJZCxcclxuICAgICAgICAgICAgICAgIHNlbGVjdGVkV2l0bmVzc0RhdGFcclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgaWYgKG5ld0Fubm90YXRpb24udHlwZSA9PT0gQU5OT1RBVElPTl9UWVBFUy52YXJpYW50KSB7XHJcbiAgICAgICAgICAgIGFjdGlvbnNCYXRjaC5wdXNoKFxyXG4gICAgICAgICAgICAgICAgYWN0aW9ucy5jaGFuZ2VkQWN0aXZlVGV4dEFubm90YXRpb24obmV3QW5ub3RhdGlvbilcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZGlzcGF0Y2goYmF0Y2hBY3Rpb25zKGFjdGlvbnNCYXRjaCkpO1xyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIC4uLnN0YXRlUHJvcHMsXHJcbiAgICAgICAgLi4ub3duUHJvcHMsXHJcbiAgICAgICAgY2xvc2VBbm5vdGF0aW9uOiAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGFjdGl2ZUFubm90YXRpb24gPSBzdGF0ZVByb3BzLmFjdGl2ZUFubm90YXRpb247XHJcbiAgICAgICAgICAgIGlmIChhY3RpdmVBbm5vdGF0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkaXNtaXNzVGV4dEFubm90YXRpb24gPVxyXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbnMuY2hhbmdlZEFjdGl2ZVRleHRBbm5vdGF0aW9uKG51bGwpO1xyXG4gICAgICAgICAgICAgICAgZGlzcGF0Y2goZGlzbWlzc1RleHRBbm5vdGF0aW9uKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZGlkU2VsZWN0QW5ub3RhdGlvbjogKGFubm90YXRpb246IEFubm90YXRpb24pID0+IHtcclxuICAgICAgICAgICAgbGV0IHNlbGVjdGVkQW5ub3RhdGlvbjogQW5ub3RhdGlvbiB8IG51bGwgPSBudWxsO1xyXG4gICAgICAgICAgICBpZiAoYW5ub3RhdGlvbi5pZCA9PSBCQVNFX0FOTk9UQVRJT05fSUQpIHtcclxuICAgICAgICAgICAgICAgIHNlbGVjdGVkQW5ub3RhdGlvbiA9IHN0YXRlUHJvcHMuYmFzZUFubm90YXRpb247XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzZWxlY3RlZEFubm90YXRpb24gPVxyXG4gICAgICAgICAgICAgICAgICAgIF8uZmluZChcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVQcm9wcy5hdmFpbGFibGVBbm5vdGF0aW9ucyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKHZhbHVlKSA9PiB2YWx1ZS51bmlxdWVJZCA9PSBhbm5vdGF0aW9uLnVuaXF1ZUlkXHJcbiAgICAgICAgICAgICAgICAgICAgKSB8fCBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxldCBhY3Rpb25zQmF0Y2ggPSBbXTtcclxuICAgICAgICAgICAgbGV0IHNlbGVjdGVkV2l0bmVzcyA9IHN0YXRlUHJvcHMuc2VsZWN0ZWRXaXRuZXNzO1xyXG4gICAgICAgICAgICAvLyBsZXQgc2VsZWN0ZWRXaXRuZXNzRGF0YSA9IHJlZHVjZXJzLmdldFdpdG5lc3NEYXRhKFxyXG4gICAgICAgICAgICAvLyAgICAgc3RhdGUsXHJcbiAgICAgICAgICAgIC8vICAgICBzZWxlY3RlZFdpdG5lc3MuaWRcclxuICAgICAgICAgICAgLy8gKTtcclxuICAgICAgICAgICAgbGV0IHNlbGVjdGVkV2l0bmVzc0RhdGEgPSByZWR1Y2Vycy5kYXRhRnJvbVdpdG5lc3Moc2VsZWN0ZWRXaXRuZXNzKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChhbm5vdGF0aW9uLnVuaXF1ZUlkICE9IHN0YXRlUHJvcHMuYWN0aXZlQW5ub3RhdGlvbi51bmlxdWVJZCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkV2l0bmVzcy5pc1dvcmtpbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYW5ub3RhdGlvbi5pZCAhPSBCQVNFX0FOTk9UQVRJT05fSUQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc0JhdGNoLnB1c2goXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zLmFwcGxpZWRBbm5vdGF0aW9uKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkQW5ub3RhdGlvbi51bmlxdWVJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZFdpdG5lc3NEYXRhXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZVByb3BzLmFjdGl2ZUFubm90YXRpb24uaWQgIT0gQkFTRV9BTk5PVEFUSU9OX0lEKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnNCYXRjaC5wdXNoKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9ucy5yZW1vdmVkQXBwbGllZEFubm90YXRpb24oXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVQcm9wcy5hY3RpdmVBbm5vdGF0aW9uLnVuaXF1ZUlkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkV2l0bmVzc0RhdGFcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVQcm9wcy5hY3RpdmVBbm5vdGF0aW9uLmNyZWF0b3JXaXRuZXNzLmlkID09PVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZFdpdG5lc3MuaWRcclxuICAgICAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVwbGFjaW5nIGEgZGVmYXVsdCBhbm5vdGF0aW9uXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDdXJyZW50bHkgc2VsZWN0ZWQgYW5ub3RhdGlvbiBpcyBhIGRlZmF1bHRcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW5ub3RhdGlvbi4gU28gbmVlZCB0byByZW1vdmUgdGhhdCB0aGVuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFwcGx5IHRoZSBuZXdseSBzZWxlY3RlZCBhbm5vdGF0aW9uLlxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc0JhdGNoLnB1c2goXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zLnJlbW92ZWREZWZhdWx0QW5ub3RhdGlvbihcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZVByb3BzLmFjdGl2ZUFubm90YXRpb24udW5pcXVlSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRXaXRuZXNzRGF0YVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkQW5ub3RhdGlvbi5pZCAhPT0gQkFTRV9BTk5PVEFUSU9OX0lEKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zQmF0Y2gucHVzaChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zLmFwcGxpZWRBbm5vdGF0aW9uKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZEFubm90YXRpb24udW5pcXVlSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkV2l0bmVzc0RhdGFcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRBbm5vdGF0aW9uLmNyZWF0b3JXaXRuZXNzLmlkID09PVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRXaXRuZXNzLmlkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc0JhdGNoLnB1c2goXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9ucy5hcHBsaWVkRGVmYXVsdEFubm90YXRpb24oXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkQW5ub3RhdGlvbi51bmlxdWVJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRXaXRuZXNzRGF0YVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZEFubm90YXRpb24uaWQgIT09IEJBU0VfQU5OT1RBVElPTl9JRFxyXG4gICAgICAgICAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnNCYXRjaC5wdXNoKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnMuYXBwbGllZEFubm90YXRpb24oXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkQW5ub3RhdGlvbi51bmlxdWVJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRXaXRuZXNzRGF0YVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlUHJvcHMuYWN0aXZlQW5ub3RhdGlvbi5pZCAhPT1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJBU0VfQU5OT1RBVElPTl9JRFxyXG4gICAgICAgICAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnNCYXRjaC5wdXNoKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnMucmVtb3ZlZEFwcGxpZWRBbm5vdGF0aW9uKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZVByb3BzLmFjdGl2ZUFubm90YXRpb24udW5pcXVlSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkV2l0bmVzc0RhdGFcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGFjdGlvbnNCYXRjaC5wdXNoKFxyXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbnMuY2hhbmdlZEFjdGl2ZVRleHRBbm5vdGF0aW9uKHNlbGVjdGVkQW5ub3RhdGlvbilcclxuICAgICAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICAgICAgZGlzcGF0Y2goYmF0Y2hBY3Rpb25zKGFjdGlvbnNCYXRjaCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlZGl0QW5ub3RhdGlvbjogKHNlbGVjdGVkQW5ub3RhdGlvbjogQW5ub3RhdGlvbikgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBiYXNlZE9uID1cclxuICAgICAgICAgICAgICAgIHNlbGVjdGVkQW5ub3RhdGlvbi5pc1dvcmtpbmdBbm5vdGF0aW9uIHx8XHJcbiAgICAgICAgICAgICAgICBzZWxlY3RlZEFubm90YXRpb24udXNlckNyZWF0ZWQgfHxcclxuICAgICAgICAgICAgICAgIHNlbGVjdGVkQW5ub3RhdGlvbi5pZCA9PT0gQkFTRV9BTk5PVEFUSU9OX0lEXHJcbiAgICAgICAgICAgICAgICAgICAgPyBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgOiBzZWxlY3RlZEFubm90YXRpb247XHJcbiAgICAgICAgICAgIGNvbnN0IHRlbXBvcmFyeUFubm90YXRpb24gPSBuZXcgVGVtcG9yYXJ5QW5ub3RhdGlvbihcclxuICAgICAgICAgICAgICAgIGJhc2VkT24sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3RlZEFubm90YXRpb24ud2l0bmVzcyxcclxuICAgICAgICAgICAgICAgIHNlbGVjdGVkQW5ub3RhdGlvbi5zdGFydCxcclxuICAgICAgICAgICAgICAgIHNlbGVjdGVkQW5ub3RhdGlvbi5sZW5ndGgsXHJcbiAgICAgICAgICAgICAgICBzZWxlY3RlZEFubm90YXRpb24uY29udGVudCxcclxuICAgICAgICAgICAgICAgIHNlbGVjdGVkQW5ub3RhdGlvbi50eXBlLFxyXG4gICAgICAgICAgICAgICAgc3RhdGVQcm9wcy5zZWxlY3RlZFdpdG5lc3MsXHJcbiAgICAgICAgICAgICAgICBzdGF0ZVByb3BzLnVzZXJcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgaWYgKHNlbGVjdGVkQW5ub3RhdGlvbi51c2VyQ3JlYXRlZCkge1xyXG4gICAgICAgICAgICAgICAgLy8gdXNlciBhbm5vdGF0aW9ucyBhcmUgdXBkYXRlZFxyXG4gICAgICAgICAgICAgICAgdGVtcG9yYXJ5QW5ub3RhdGlvbi51bmlxdWVJZCA9IHNlbGVjdGVkQW5ub3RhdGlvbi51bmlxdWVJZDtcclxuICAgICAgICAgICAgICAgIHRlbXBvcmFyeUFubm90YXRpb24uaXNTYXZlZCA9IHNlbGVjdGVkQW5ub3RhdGlvbi5pc1NhdmVkO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkaXNwYXRjaChcclxuICAgICAgICAgICAgICAgIGFjdGlvbnMuYWRkZWRUZW1wb3JhcnlBbm5vdGF0aW9uKHRlbXBvcmFyeUFubm90YXRpb24sIHRydWUpXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzYXZlQW5ub3RhdGlvbjogc2F2ZUFubm90YXRpb24sXHJcbiAgICAgICAgY2FuY2VsRWRpdEFubm90YXRpb246IChzZWxlY3RlZEFubm90YXRpb246IFRlbXBvcmFyeUFubm90YXRpb24pID0+IHtcclxuICAgICAgICAgICAgaWYgKCFzZWxlY3RlZEFubm90YXRpb24uaXNUZW1wb3JhcnkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcclxuICAgICAgICAgICAgICAgICAgICBcIlRyaWVkIHRvIGNhbGwgY2FuY2VsRWRpdEFubm90YXRpb24gb24gYSBub24tdGVtcG9yYXJ5IGFubm90YXRpb246ICVvXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRBbm5vdGF0aW9uXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBjYW5jZWxBY3Rpb24gPVxyXG4gICAgICAgICAgICAgICAgYWN0aW9ucy5yZW1vdmVkVGVtcG9yYXJ5QW5ub3RhdGlvbihzZWxlY3RlZEFubm90YXRpb24pO1xyXG4gICAgICAgICAgICBkaXNwYXRjaChjYW5jZWxBY3Rpb24pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZGVsZXRlQW5ub3RhdGlvbjogKGFubm90YXRpb246IEFubm90YXRpb24pID0+IHtcclxuICAgICAgICAgICAgbGV0IHNlbGVjdGVkV2l0bmVzcyA9IHN0YXRlUHJvcHMuc2VsZWN0ZWRXaXRuZXNzO1xyXG4gICAgICAgICAgICBsZXQgc2VsZWN0ZWRXaXRuZXNzRGF0YSA9IHJlZHVjZXJzLmRhdGFGcm9tV2l0bmVzcyhzZWxlY3RlZFdpdG5lc3MpO1xyXG4gICAgICAgICAgICBsZXQgYWN0aW9uc0JhdGNoID0gW107XHJcbiAgICAgICAgICAgIGlmIChhbm5vdGF0aW9uLnVzZXJDcmVhdGVkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkZWxldGVBY3Rpb24gPSBhY3Rpb25zLmRlbGV0ZWRBbm5vdGF0aW9uKFxyXG4gICAgICAgICAgICAgICAgICAgIGFubm90YXRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRXaXRuZXNzXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcmVtb3ZlQXBwbGllZEFjdGlvbiA9IGFjdGlvbnMucmVtb3ZlZEFwcGxpZWRBbm5vdGF0aW9uKFxyXG4gICAgICAgICAgICAgICAgICAgIGFubm90YXRpb24udW5pcXVlSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRXaXRuZXNzRGF0YVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIGFjdGlvbnNCYXRjaCA9IFtkZWxldGVBY3Rpb24sIHJlbW92ZUFwcGxpZWRBY3Rpb25dO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gQXNzdW1lIHRoaXMgaXMgYSBkZWZhdWx0IGFubm90YXRpb24gdGhhdCB3YXNcclxuICAgICAgICAgICAgICAgIC8vIGF1dG9tYXRpY2FsbHkgaW1wb3J0ZWQgZnJvbSBleHRlcm5hbCBkYXRhXHJcbiAgICAgICAgICAgICAgICBjb25zdCByZW1vdmVEZWZhdWx0QW5ub3RhdGlvbiA9XHJcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9ucy5yZW1vdmVkRGVmYXVsdEFubm90YXRpb24oXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFubm90YXRpb24udW5pcXVlSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkV2l0bmVzc0RhdGFcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgYWN0aW9uc0JhdGNoID0gW3JlbW92ZURlZmF1bHRBbm5vdGF0aW9uXTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHN0YXRlUHJvcHMuYWN0aXZlQW5ub3RhdGlvbi51bmlxdWVJZCA9PT0gYW5ub3RhdGlvbi51bmlxdWVJZCkge1xyXG4gICAgICAgICAgICAgICAgYWN0aW9uc0JhdGNoLnB1c2goYWN0aW9ucy5jaGFuZ2VkQWN0aXZlVGV4dEFubm90YXRpb24obnVsbCkpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkaXNwYXRjaChiYXRjaEFjdGlvbnMoYWN0aW9uc0JhdGNoKSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBhZGROb3RlOiAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGFjdGl2ZUFubm90YXRpb24gPSBvd25Qcm9wcy5hY3RpdmVBbm5vdGF0aW9uO1xyXG4gICAgICAgICAgICBjb25zdCB0ZW1wb3JhcnlBbm5vdGF0aW9uID0gbmV3IFRlbXBvcmFyeUFubm90YXRpb24oXHJcbiAgICAgICAgICAgICAgICBudWxsLFxyXG4gICAgICAgICAgICAgICAgYWN0aXZlQW5ub3RhdGlvbi53aXRuZXNzLFxyXG4gICAgICAgICAgICAgICAgYWN0aXZlQW5ub3RhdGlvbi5zdGFydCxcclxuICAgICAgICAgICAgICAgIGFjdGl2ZUFubm90YXRpb24ubGVuZ3RoLFxyXG4gICAgICAgICAgICAgICAgXCJcIixcclxuICAgICAgICAgICAgICAgIEFOTk9UQVRJT05fVFlQRVMubm90ZSxcclxuICAgICAgICAgICAgICAgIHN0YXRlUHJvcHMuc2VsZWN0ZWRXaXRuZXNzLFxyXG4gICAgICAgICAgICAgICAgc3RhdGVQcm9wcy51c2VyXHJcbiAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICBkaXNwYXRjaChcclxuICAgICAgICAgICAgICAgIGFjdGlvbnMuYWRkZWRUZW1wb3JhcnlBbm5vdGF0aW9uKHRlbXBvcmFyeUFubm90YXRpb24sIHRydWUpXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlZGl0Tm90ZTogKG5vdGU6IEFubm90YXRpb24pID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdGVtcG9yYXJ5QW5ub3RhdGlvbiA9IG5ldyBUZW1wb3JhcnlBbm5vdGF0aW9uKFxyXG4gICAgICAgICAgICAgICAgbm90ZSxcclxuICAgICAgICAgICAgICAgIG5vdGUud2l0bmVzcyxcclxuICAgICAgICAgICAgICAgIG5vdGUuc3RhcnQsXHJcbiAgICAgICAgICAgICAgICBub3RlLmxlbmd0aCxcclxuICAgICAgICAgICAgICAgIG5vdGUuY29udGVudCxcclxuICAgICAgICAgICAgICAgIEFOTk9UQVRJT05fVFlQRVMubm90ZSxcclxuICAgICAgICAgICAgICAgIHN0YXRlUHJvcHMuc2VsZWN0ZWRXaXRuZXNzLFxyXG4gICAgICAgICAgICAgICAgc3RhdGVQcm9wcy51c2VyXHJcbiAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICBkaXNwYXRjaChcclxuICAgICAgICAgICAgICAgIGFjdGlvbnMuYWRkZWRUZW1wb3JhcnlBbm5vdGF0aW9uKHRlbXBvcmFyeUFubm90YXRpb24sIHRydWUpXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBhZGRQYWdlQnJlYWs6IGFkZEJyZWFrKEFOTk9UQVRJT05fVFlQRVMucGFnZUJyZWFrKSxcclxuICAgICAgICBhZGRMaW5lQnJlYWs6IGFkZEJyZWFrKEFOTk9UQVRJT05fVFlQRVMubGluZUJyZWFrKSxcclxuICAgICAgICBhZGRRdWVzdGlvbjogKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBhY3RpdmVBbm5vdGF0aW9uID0gb3duUHJvcHMuYWN0aXZlQW5ub3RhdGlvbjtcclxuICAgICAgICAgICAgY29uc3QgdGVtcG9yYXJ5QW5ub3RhdGlvbiA9IG5ldyBUZW1wb3JhcnlBbm5vdGF0aW9uKFxyXG4gICAgICAgICAgICAgICAgbnVsbCxcclxuICAgICAgICAgICAgICAgIGFjdGl2ZUFubm90YXRpb24ud2l0bmVzcyxcclxuICAgICAgICAgICAgICAgIGFjdGl2ZUFubm90YXRpb24uc3RhcnQsXHJcbiAgICAgICAgICAgICAgICBhY3RpdmVBbm5vdGF0aW9uLmxlbmd0aCxcclxuICAgICAgICAgICAgICAgIFwiXCIsXHJcbiAgICAgICAgICAgICAgICBBTk5PVEFUSU9OX1RZUEVTLnF1ZXN0aW9uLFxyXG4gICAgICAgICAgICAgICAgc3RhdGVQcm9wcy5zZWxlY3RlZFdpdG5lc3MsXHJcbiAgICAgICAgICAgICAgICBzdGF0ZVByb3BzLnVzZXJcclxuICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgIGRpc3BhdGNoKFxyXG4gICAgICAgICAgICAgICAgYWN0aW9ucy5hZGRlZFRlbXBvcmFyeUFubm90YXRpb24odGVtcG9yYXJ5QW5ub3RhdGlvbiwgdHJ1ZSlcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNhdmVRdWVzdGlvbjogKFxyXG4gICAgICAgICAgICBxdWVzdGlvbjogVGVtcG9yYXJ5QW5ub3RhdGlvbixcclxuICAgICAgICAgICAgdGl0bGU6IHN0cmluZyxcclxuICAgICAgICAgICAgY29udGVudDogc3RyaW5nXHJcbiAgICAgICAgKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBbc3RhcnQsIGVuZF0gPVxyXG4gICAgICAgICAgICAgICAgb3duUHJvcHMuYW5ub3RhdGVkVGV4dC5nZXRQb3NpdGlvbk9mQW5ub3RhdGlvbihxdWVzdGlvbik7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBxdWVzdGlvblF1b3RlVGV4dCA9IFJlYWN0RE9NU2VydmVyLnJlbmRlclRvU3RhdGljTWFya3VwKFxyXG4gICAgICAgICAgICAgICAgc3RhdGVQcm9wcy5xdWVzdGlvblF1b3RlXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIGxldCBxdWVzdGlvblRleHQgPSBxdWVzdGlvblF1b3RlVGV4dCArIGNvbnRlbnQ7XHJcblxyXG4gICAgICAgICAgICBzYXZlQW5ub3RhdGlvbihxdWVzdGlvbiwgY29udGVudCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGNyZWF0ZWRRdWVzdGlvbkFjdGlvbiA9IGFjdGlvbnMuY3JlYXRlZFF1ZXN0aW9uKFxyXG4gICAgICAgICAgICAgICAgcXVlc3Rpb24sXHJcbiAgICAgICAgICAgICAgICB0aXRsZSxcclxuICAgICAgICAgICAgICAgIHF1ZXN0aW9uVGV4dFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBkaXNwYXRjaChjcmVhdGVkUXVlc3Rpb25BY3Rpb24pO1xyXG4gICAgICAgIH0sXHJcbiAgICB9O1xyXG59O1xyXG5cclxuY29uc3QgQW5ub3RhdGlvbkNvbnRyb2xzQ29udGFpbmVyID0gY29ubmVjdChcclxuICAgIG1hcFN0YXRlVG9Qcm9wcyxcclxuICAgIG51bGwsXHJcbiAgICBtZXJnZVByb3BzXHJcbikoQW5ub3RhdGlvbkNvbnRyb2xzKTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IEFubm90YXRpb25Db250cm9sc0NvbnRhaW5lcjtcclxuIl0sIm5hbWVzIjpbIlJlYWN0IiwiY29ubmVjdCIsInVzZVN0b3JlIiwiYmF0Y2hBY3Rpb25zIiwiQW5ub3RhdGlvbkNvbnRyb2xzIiwiYWRkVGliZXRhblNoYXkiLCJyZWR1Y2VycyIsImFjdGlvbnMiLCJCQVNFX0FOTk9UQVRJT05fSUQiLCJBbm5vdGF0aW9uIiwiQU5OT1RBVElPTl9UWVBFUyIsIlRlbXBvcmFyeUFubm90YXRpb24iLCJBbm5vdGF0ZWRUZXh0IiwiVXNlciIsIldpdG5lc3MiLCJUZXh0U2VnbWVudCIsIlNwbGl0VGV4dCIsIl8iLCJjaGFuZ2VkQWN0aXZlVGV4dEFubm90YXRpb24iLCJSZWFjdERPTVNlcnZlciIsIlF1ZXN0aW9uIiwiZ2V0VGV4dEZvbnRTaXplIiwiVEVNUE9SQVJZX0FOTk9UQVRJT05fSUQiLCJCQVNFX05BTUUiLCJnZXRBbm5vdGF0aW9uc0RhdGEiLCJhbm5vdGF0aW9ucyIsInNvdXJjZXMiLCJ3b3JraW5nU291cmNlTmFtZSIsInNlbGVjdGVkVGV4dCIsImFubm90YXRpb25zRGF0YSIsImJhc2VTb3VyY2VzIiwiZmlsdGVyIiwic291cmNlIiwiaXNXb3JraW5nIiwiaXNCYXNlIiwiYmFzZVNvdXJjZU5hbWVzIiwibWFwIiwibmFtZSIsImFubm90YXRpb25zQnlJZCIsImkiLCJhbm5vdGF0aW9uIiwiaWQiLCJjb250ZW50Iiwic3RhcnQiLCJpc1RlbXBvcmFyeSIsImdldFNvdXJjZU5hbWUiLCJ1bmlxdWVJZCIsImEiLCJleGlzdGluZ0Fubm90YXRpb24iLCJ1c2VyQ3JlYXRlZCIsImNyZWF0b3JXaXRuZXNzIiwibGVuZ3RoIiwidW5zaGlmdCIsIkJhc2UiLCJsIiwiT2JqZWN0Iiwia2V5cyIsInJlZHVjZSIsImFyciIsImtleSIsImFubm90YXRpb25EYXRhIiwicHJldiIsImN1ciIsInB1c2giLCJnZXRBdmFpbGFibGVBbm5vdGF0aW9ucyIsImFubm90YXRlZFRleHQiLCJhY3RpdmVBbm5vdGF0aW9uIiwidGVtcG9yYXJ5QW5ub3RhdGlvbiIsImFubm90YXRpb25Qb3NpdGlvbnMiLCJhdmFpbGFibGVBbm5vdGF0aW9ucyIsIm5hdHVyYWxJZCIsImdldFBvc2l0aW9uT2ZBbm5vdGF0aW9uIiwiZW5kIiwicG9zc2libGVBbm5vdGF0aW9ucyIsImlzSW5zZXJ0aW9uIiwiaW5zZXJ0aW9uQW5ub3RhdGlvbnMiLCJjb25jYXQiLCJhY3RpdmVJbnNlcnRpb25Bbm5vdGF0aW9ucyIsIlN0cmluZyIsInN0YXJ0QW5ub3RhdGlvbnMiLCJlbmRBbm5vdGF0aW9ucyIsImFjdGl2ZVdpdG5lc3MiLCJ0eXBlIiwicGFnZUJyZWFrIiwibGluZUJyZWFrIiwidW5pcVdpdGgiLCJiIiwiZ2V0VGVtcG9yYXJ5QW5ub3RhdGlvbiIsInN0YXRlIiwidXNlciIsIndpdG5lc3MiLCJnZXRUZW1wb3JhcnlBbm5vdGF0aW9ucyIsIm1hcFN0YXRlVG9Qcm9wcyIsIm93blByb3BzIiwiZ2V0VXNlciIsImdldFNlbGVjdGVkVGV4dCIsImlubGluZSIsInNlbGVjdGVkV2l0bmVzcyIsImdldFNlbGVjdGVkVGV4dFdpdG5lc3MiLCJnZXRXb3JraW5nV2l0bmVzcyIsImJhc2VBbm5vdGF0aW9uIiwiZmlyc3RTZWxlY3RlZFNlZ21lbnQiLCJzcGxpdFRleHRSZWN0IiwidGVtcG9yYXJ5VmFyaWFudCIsInZhcmlhbnQiLCJ2YXJpYW50cyIsImdldFNvdXJjZXMiLCJnZXRUcmFuc2xhdGlvbiIsInZhcmlhbnRzRGF0YSIsImdldEJhc2VBbm5vdGF0aW9uIiwiYmFzZUFubm90YXRpb25EYXRhIiwic29ydCIsIm5vdGVzIiwibm90ZSIsInRlbXBvcmFyeU5vdGVzIiwicXVlc3Rpb25Bbm5vdGF0aW9ucyIsInF1ZXN0aW9uIiwicXVlc3Rpb25zRGF0YSIsImlzTG9hZGluZyIsInF1ZXN0aW9uSXNMb2FkaW5nIiwicXVlc3Rpb25zIiwiZ2V0UXVlc3Rpb25zIiwidGVtcG9yYXJ5UXVlc3Rpb25zIiwicXVlc3Rpb25RdW90ZSIsImZpcnN0UXVlc3Rpb24iLCJzZWdtZW50ZWRUZXh0IiwiZXh0cmFjdFRleHRBcm91bmRQb3NpdGlvbiIsInN0YXJ0VGV4dCIsIm1haW5UZXh0IiwiZW5kVGV4dCIsImxpbmtVcmwiLCJkb2N1bWVudCIsImxvY2F0aW9uIiwiaHJlZiIsImZvbnRTaXplIiwibWVyZ2VQcm9wcyIsInN0YXRlUHJvcHMiLCJkaXNwYXRjaFByb3BzIiwiZGlzcGF0Y2giLCJsb2FkUXVlc3Rpb25EYXRhIiwiaGFzT3duUHJvcGVydHkiLCJsb2FkaW5nIiwibG9hZFF1ZXN0aW9uIiwiYWRkQnJlYWsiLCJicmVha1R5cGUiLCJzZWxlY3RCcmVhayIsImJyZWFrQW5ub3RhdGlvbiIsInNlbGVjdGVkV2l0bmVzc0RhdGEiLCJkYXRhRnJvbVdpdG5lc3MiLCJhY3Rpb25zQmF0Y2giLCJjcmVhdGVkQW5ub3RhdGlvbiIsImFwcGxpZWRBbm5vdGF0aW9uIiwic2F2ZUFubm90YXRpb24iLCJzZWxlY3RlZEFubm90YXRpb24iLCJjb25zb2xlIiwid2FybiIsIm5ld0Fubm90YXRpb24iLCJiYXNlZE9uIiwiaXNTYXZlZCIsImFjdGlvbiIsInVwZGF0ZWRBbm5vdGF0aW9uIiwicmVtb3ZlZFRlbXBvcmFyeUFubm90YXRpb24iLCJjbG9zZUFubm90YXRpb24iLCJkaXNtaXNzVGV4dEFubm90YXRpb24iLCJkaWRTZWxlY3RBbm5vdGF0aW9uIiwiZmluZCIsInZhbHVlIiwicmVtb3ZlZEFwcGxpZWRBbm5vdGF0aW9uIiwicmVtb3ZlZERlZmF1bHRBbm5vdGF0aW9uIiwiYXBwbGllZERlZmF1bHRBbm5vdGF0aW9uIiwiZWRpdEFubm90YXRpb24iLCJpc1dvcmtpbmdBbm5vdGF0aW9uIiwiYWRkZWRUZW1wb3JhcnlBbm5vdGF0aW9uIiwiY2FuY2VsRWRpdEFubm90YXRpb24iLCJjYW5jZWxBY3Rpb24iLCJkZWxldGVBbm5vdGF0aW9uIiwiZGVsZXRlQWN0aW9uIiwiZGVsZXRlZEFubm90YXRpb24iLCJyZW1vdmVBcHBsaWVkQWN0aW9uIiwicmVtb3ZlRGVmYXVsdEFubm90YXRpb24iLCJhZGROb3RlIiwiZWRpdE5vdGUiLCJhZGRQYWdlQnJlYWsiLCJhZGRMaW5lQnJlYWsiLCJhZGRRdWVzdGlvbiIsInNhdmVRdWVzdGlvbiIsInRpdGxlIiwicXVlc3Rpb25RdW90ZVRleHQiLCJyZW5kZXJUb1N0YXRpY01hcmt1cCIsInF1ZXN0aW9uVGV4dCIsImNyZWF0ZWRRdWVzdGlvbkFjdGlvbiIsImNyZWF0ZWRRdWVzdGlvbiIsIkFubm90YXRpb25Db250cm9sc0NvbnRhaW5lciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./app/components/TextDetail/AnnotationControlsContainer.js\n");

/***/ }),

/***/ "./app/lib/SplitText.js":
/*!******************************!*\
  !*** ./app/lib/SplitText.js ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ SplitText)\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ \"./node_modules/@babel/runtime/helpers/esm/classCallCheck.js\");\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/createClass */ \"./node_modules/@babel/runtime/helpers/esm/createClass.js\");\n/* harmony import */ var _SegmentedText__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./SegmentedText */ \"./app/lib/SegmentedText.js\");\n/* harmony import */ var _AnnotatedText__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./AnnotatedText */ \"./app/lib/AnnotatedText.js\");\n\n\n\n\n\nvar SplitText = /*#__PURE__*/function () {\n  function SplitText(annotatedText, splitter) {\n    (0,_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(this, SplitText);\n\n    this.annotatedText = annotatedText;\n    this.splitter = splitter;\n    this._texts = null;\n    this._textsId = null;\n    this._textsFinalPositions = [];\n  }\n\n  (0,_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(SplitText, [{\n    key: \"texts\",\n    get: function get() {\n      if (!this.annotatedText) {\n        return [];\n      }\n\n      if (!this._texts || this._textsId !== this.annotatedText.getUniqueId()) {\n        this._textsFinalPositions = [];\n        var segmentedText = this.annotatedText.segmentedText;\n        var textString = segmentedText.getText();\n        var splitPositions = this.splitter(textString).filter(function (l) {\n          return l !== 0;\n        });\n\n        if (splitPositions.length === 0) {\n          this._textsFinalPositions.push(textString.length);\n\n          return [segmentedText];\n        }\n\n        var lastPosition = splitPositions[splitPositions.length - 1];\n\n        if (lastPosition + 1 < textString.length) {\n          splitPositions.push(textString.length - 1);\n        }\n\n        var segments = segmentedText.segments;\n        var startIndex = 0;\n        var texts = [];\n\n        for (var i = 0; i < splitPositions.length; i++) {\n          var position = splitPositions[i];\n          var endIndex = segmentedText.indexOfSegmentAtPosition(position - 1);\n          var textSegments = void 0;\n\n          if (i == splitPositions.length - 1) {\n            // final position\n            textSegments = segments.slice(startIndex);\n          } else {\n            textSegments = segments.slice(startIndex, endIndex + 1);\n          }\n\n          var text = new _SegmentedText__WEBPACK_IMPORTED_MODULE_2__[\"default\"](textSegments);\n          texts.push(text);\n          startIndex = endIndex + 1;\n\n          if (endIndex >= 0) {\n            var finalSegment = segments[endIndex];\n\n            this._textsFinalPositions.push(finalSegment.end);\n          }\n        }\n\n        this._texts = texts.filter(function (l) {\n          return l.segments.length > 0;\n        });\n        this._textsId = this.annotatedText.getUniqueId();\n      }\n\n      return this._texts || [];\n    }\n  }, {\n    key: \"getTextsFinalPositions\",\n    value: function getTextsFinalPositions() {\n      this.texts;\n      return this._textsFinalPositions;\n    }\n    /**\r\n     * Return the index of the text portion that contains the given position.\r\n     *\r\n     * @param position\r\n     * @returns number\r\n     */\n\n  }, {\n    key: \"getTextIndexOfPosition\",\n    value: function getTextIndexOfPosition(position) {\n      var textsFinalPositions = this.getTextsFinalPositions();\n      var lastPosition = 0;\n      var textIndex = null;\n\n      for (var i = 0; i < textsFinalPositions.length; i++) {\n        var endPosition = textsFinalPositions[i];\n\n        if (position >= lastPosition && position <= endPosition) {\n          textIndex = i;\n          break;\n        }\n\n        lastPosition = endPosition;\n      }\n\n      if (textIndex === null) {\n        // Likely an insertion at the end of a text\n        console.warn(\"no index for position %d\", position);\n        textIndex = textsFinalPositions.length - 1;\n      }\n\n      return textIndex;\n    }\n  }]);\n\n  return SplitText;\n}();\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9hcHAvbGliL1NwbGl0VGV4dC5qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQ0E7QUFDQTs7SUFJcUJFO0VBT2pCLG1CQUFZQyxhQUFaLEVBQTBDQyxRQUExQyxFQUE4RDtJQUFBOztJQUMxRCxLQUFLRCxhQUFMLEdBQXFCQSxhQUFyQjtJQUNBLEtBQUtDLFFBQUwsR0FBZ0JBLFFBQWhCO0lBQ0EsS0FBS0MsTUFBTCxHQUFjLElBQWQ7SUFDQSxLQUFLQyxRQUFMLEdBQWdCLElBQWhCO0lBQ0EsS0FBS0Msb0JBQUwsR0FBNEIsRUFBNUI7RUFDSDs7OztTQUVELGVBQTZCO01BQ3pCLElBQUksQ0FBQyxLQUFLSixhQUFWLEVBQXlCO1FBQ3JCLE9BQU8sRUFBUDtNQUNIOztNQUNELElBQ0ksQ0FBQyxLQUFLRSxNQUFOLElBQ0EsS0FBS0MsUUFBTCxLQUFrQixLQUFLSCxhQUFMLENBQW1CSyxXQUFuQixFQUZ0QixFQUdFO1FBQ0UsS0FBS0Qsb0JBQUwsR0FBNEIsRUFBNUI7UUFDQSxJQUFNRSxhQUFhLEdBQUcsS0FBS04sYUFBTCxDQUFtQk0sYUFBekM7UUFDQSxJQUFNQyxVQUFVLEdBQUdELGFBQWEsQ0FBQ0UsT0FBZCxFQUFuQjtRQUNBLElBQUlDLGNBQWMsR0FBRyxLQUFLUixRQUFMLENBQWNNLFVBQWQsRUFBMEJHLE1BQTFCLENBQ2pCLFVBQUNDLENBQUQ7VUFBQSxPQUFPQSxDQUFDLEtBQUssQ0FBYjtRQUFBLENBRGlCLENBQXJCOztRQUdBLElBQUlGLGNBQWMsQ0FBQ0csTUFBZixLQUEwQixDQUE5QixFQUFpQztVQUM3QixLQUFLUixvQkFBTCxDQUEwQlMsSUFBMUIsQ0FBK0JOLFVBQVUsQ0FBQ0ssTUFBMUM7O1VBQ0EsT0FBTyxDQUFDTixhQUFELENBQVA7UUFDSDs7UUFDRCxJQUFJUSxZQUFZLEdBQUdMLGNBQWMsQ0FBQ0EsY0FBYyxDQUFDRyxNQUFmLEdBQXdCLENBQXpCLENBQWpDOztRQUNBLElBQUlFLFlBQVksR0FBRyxDQUFmLEdBQW1CUCxVQUFVLENBQUNLLE1BQWxDLEVBQTBDO1VBQ3RDSCxjQUFjLENBQUNJLElBQWYsQ0FBb0JOLFVBQVUsQ0FBQ0ssTUFBWCxHQUFvQixDQUF4QztRQUNIOztRQUNELElBQU1HLFFBQVEsR0FBR1QsYUFBYSxDQUFDUyxRQUEvQjtRQUNBLElBQUlDLFVBQVUsR0FBRyxDQUFqQjtRQUNBLElBQUlDLEtBQUssR0FBRyxFQUFaOztRQUNBLEtBQUssSUFBSUMsQ0FBQyxHQUFHLENBQWIsRUFBZ0JBLENBQUMsR0FBR1QsY0FBYyxDQUFDRyxNQUFuQyxFQUEyQ00sQ0FBQyxFQUE1QyxFQUFnRDtVQUM1QyxJQUFNQyxRQUFRLEdBQUdWLGNBQWMsQ0FBQ1MsQ0FBRCxDQUEvQjtVQUNBLElBQU1FLFFBQVEsR0FBR2QsYUFBYSxDQUFDZSx3QkFBZCxDQUNiRixRQUFRLEdBQUcsQ0FERSxDQUFqQjtVQUdBLElBQUlHLFlBQVksU0FBaEI7O1VBQ0EsSUFBSUosQ0FBQyxJQUFJVCxjQUFjLENBQUNHLE1BQWYsR0FBd0IsQ0FBakMsRUFBb0M7WUFDaEM7WUFDQVUsWUFBWSxHQUFHUCxRQUFRLENBQUNRLEtBQVQsQ0FBZVAsVUFBZixDQUFmO1VBQ0gsQ0FIRCxNQUdPO1lBQ0hNLFlBQVksR0FBR1AsUUFBUSxDQUFDUSxLQUFULENBQWVQLFVBQWYsRUFBMkJJLFFBQVEsR0FBRyxDQUF0QyxDQUFmO1VBQ0g7O1VBRUQsSUFBTUksSUFBSSxHQUFHLElBQUkzQixzREFBSixDQUFrQnlCLFlBQWxCLENBQWI7VUFDQUwsS0FBSyxDQUFDSixJQUFOLENBQVdXLElBQVg7VUFDQVIsVUFBVSxHQUFHSSxRQUFRLEdBQUcsQ0FBeEI7O1VBQ0EsSUFBSUEsUUFBUSxJQUFJLENBQWhCLEVBQW1CO1lBQ2YsSUFBTUssWUFBWSxHQUFHVixRQUFRLENBQUNLLFFBQUQsQ0FBN0I7O1lBQ0EsS0FBS2hCLG9CQUFMLENBQTBCUyxJQUExQixDQUErQlksWUFBWSxDQUFDQyxHQUE1QztVQUNIO1FBQ0o7O1FBRUQsS0FBS3hCLE1BQUwsR0FBY2UsS0FBSyxDQUFDUCxNQUFOLENBQWEsVUFBQ0MsQ0FBRDtVQUFBLE9BQU9BLENBQUMsQ0FBQ0ksUUFBRixDQUFXSCxNQUFYLEdBQW9CLENBQTNCO1FBQUEsQ0FBYixDQUFkO1FBQ0EsS0FBS1QsUUFBTCxHQUFnQixLQUFLSCxhQUFMLENBQW1CSyxXQUFuQixFQUFoQjtNQUNIOztNQUNELE9BQU8sS0FBS0gsTUFBTCxJQUFlLEVBQXRCO0lBQ0g7OztXQUVELGtDQUFtQztNQUMvQixLQUFLZSxLQUFMO01BQ0EsT0FBTyxLQUFLYixvQkFBWjtJQUNIO0lBRUQ7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O1dBQ0ksZ0NBQXVCZSxRQUF2QixFQUFpRDtNQUM3QyxJQUFNUSxtQkFBbUIsR0FBRyxLQUFLQyxzQkFBTCxFQUE1QjtNQUNBLElBQUlkLFlBQVksR0FBRyxDQUFuQjtNQUNBLElBQUllLFNBQVMsR0FBRyxJQUFoQjs7TUFDQSxLQUFLLElBQUlYLENBQUMsR0FBRyxDQUFiLEVBQWdCQSxDQUFDLEdBQUdTLG1CQUFtQixDQUFDZixNQUF4QyxFQUFnRE0sQ0FBQyxFQUFqRCxFQUFxRDtRQUNqRCxJQUFJWSxXQUFXLEdBQUdILG1CQUFtQixDQUFDVCxDQUFELENBQXJDOztRQUNBLElBQUlDLFFBQVEsSUFBSUwsWUFBWixJQUE0QkssUUFBUSxJQUFJVyxXQUE1QyxFQUF5RDtVQUNyREQsU0FBUyxHQUFHWCxDQUFaO1VBQ0E7UUFDSDs7UUFDREosWUFBWSxHQUFHZ0IsV0FBZjtNQUNIOztNQUNELElBQUlELFNBQVMsS0FBSyxJQUFsQixFQUF3QjtRQUNwQjtRQUNBRSxPQUFPLENBQUNDLElBQVIsQ0FBYSwwQkFBYixFQUF5Q2IsUUFBekM7UUFDQVUsU0FBUyxHQUFHRixtQkFBbUIsQ0FBQ2YsTUFBcEIsR0FBNkIsQ0FBekM7TUFDSDs7TUFDRCxPQUFPaUIsU0FBUDtJQUNIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGVtaW51c2NsaWVudC8uL2FwcC9saWIvU3BsaXRUZXh0LmpzP2YwZjMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQGZsb3dcclxuaW1wb3J0IFNlZ21lbnRlZFRleHQgZnJvbSBcIi4vU2VnbWVudGVkVGV4dFwiO1xyXG5pbXBvcnQgQW5ub3RhdGVkVGV4dCBmcm9tIFwiLi9Bbm5vdGF0ZWRUZXh0XCI7XHJcblxyXG5leHBvcnQgdHlwZSBTcGxpdHRlciA9IChzdHJpbmcpID0+IG51bWJlcltdO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU3BsaXRUZXh0IHtcclxuICAgIGFubm90YXRlZFRleHQ6IEFubm90YXRlZFRleHQ7XHJcbiAgICBzcGxpdHRlcjogU3BsaXR0ZXI7XHJcbiAgICBfdGV4dHM6IFNlZ21lbnRlZFRleHRbXSB8IG51bGw7XHJcbiAgICBfdGV4dHNJZDogc3RyaW5nIHwgbnVsbDtcclxuICAgIF90ZXh0c0ZpbmFsUG9zaXRpb25zOiBudW1iZXJbXTtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihhbm5vdGF0ZWRUZXh0OiBBbm5vdGF0ZWRUZXh0LCBzcGxpdHRlcjogU3BsaXR0ZXIpIHtcclxuICAgICAgICB0aGlzLmFubm90YXRlZFRleHQgPSBhbm5vdGF0ZWRUZXh0O1xyXG4gICAgICAgIHRoaXMuc3BsaXR0ZXIgPSBzcGxpdHRlcjtcclxuICAgICAgICB0aGlzLl90ZXh0cyA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5fdGV4dHNJZCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5fdGV4dHNGaW5hbFBvc2l0aW9ucyA9IFtdO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCB0ZXh0cygpOiBTZWdtZW50ZWRUZXh0W10ge1xyXG4gICAgICAgIGlmICghdGhpcy5hbm5vdGF0ZWRUZXh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAhdGhpcy5fdGV4dHMgfHxcclxuICAgICAgICAgICAgdGhpcy5fdGV4dHNJZCAhPT0gdGhpcy5hbm5vdGF0ZWRUZXh0LmdldFVuaXF1ZUlkKClcclxuICAgICAgICApIHtcclxuICAgICAgICAgICAgdGhpcy5fdGV4dHNGaW5hbFBvc2l0aW9ucyA9IFtdO1xyXG4gICAgICAgICAgICBjb25zdCBzZWdtZW50ZWRUZXh0ID0gdGhpcy5hbm5vdGF0ZWRUZXh0LnNlZ21lbnRlZFRleHQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHRleHRTdHJpbmcgPSBzZWdtZW50ZWRUZXh0LmdldFRleHQoKTtcclxuICAgICAgICAgICAgbGV0IHNwbGl0UG9zaXRpb25zID0gdGhpcy5zcGxpdHRlcih0ZXh0U3RyaW5nKS5maWx0ZXIoXHJcbiAgICAgICAgICAgICAgICAobCkgPT4gbCAhPT0gMFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBpZiAoc3BsaXRQb3NpdGlvbnMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl90ZXh0c0ZpbmFsUG9zaXRpb25zLnB1c2godGV4dFN0cmluZy5sZW5ndGgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtzZWdtZW50ZWRUZXh0XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBsZXQgbGFzdFBvc2l0aW9uID0gc3BsaXRQb3NpdGlvbnNbc3BsaXRQb3NpdGlvbnMubGVuZ3RoIC0gMV07XHJcbiAgICAgICAgICAgIGlmIChsYXN0UG9zaXRpb24gKyAxIDwgdGV4dFN0cmluZy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHNwbGl0UG9zaXRpb25zLnB1c2godGV4dFN0cmluZy5sZW5ndGggLSAxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBzZWdtZW50cyA9IHNlZ21lbnRlZFRleHQuc2VnbWVudHM7XHJcbiAgICAgICAgICAgIGxldCBzdGFydEluZGV4ID0gMDtcclxuICAgICAgICAgICAgbGV0IHRleHRzID0gW107XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3BsaXRQb3NpdGlvbnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gc3BsaXRQb3NpdGlvbnNbaV07XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlbmRJbmRleCA9IHNlZ21lbnRlZFRleHQuaW5kZXhPZlNlZ21lbnRBdFBvc2l0aW9uKFxyXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uIC0gMVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIGxldCB0ZXh0U2VnbWVudHM7XHJcbiAgICAgICAgICAgICAgICBpZiAoaSA9PSBzcGxpdFBvc2l0aW9ucy5sZW5ndGggLSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZmluYWwgcG9zaXRpb25cclxuICAgICAgICAgICAgICAgICAgICB0ZXh0U2VnbWVudHMgPSBzZWdtZW50cy5zbGljZShzdGFydEluZGV4KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dFNlZ21lbnRzID0gc2VnbWVudHMuc2xpY2Uoc3RhcnRJbmRleCwgZW5kSW5kZXggKyAxKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gbmV3IFNlZ21lbnRlZFRleHQodGV4dFNlZ21lbnRzKTtcclxuICAgICAgICAgICAgICAgIHRleHRzLnB1c2godGV4dCk7XHJcbiAgICAgICAgICAgICAgICBzdGFydEluZGV4ID0gZW5kSW5kZXggKyAxO1xyXG4gICAgICAgICAgICAgICAgaWYgKGVuZEluZGV4ID49IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaW5hbFNlZ21lbnQgPSBzZWdtZW50c1tlbmRJbmRleF07XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGV4dHNGaW5hbFBvc2l0aW9ucy5wdXNoKGZpbmFsU2VnbWVudC5lbmQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLl90ZXh0cyA9IHRleHRzLmZpbHRlcigobCkgPT4gbC5zZWdtZW50cy5sZW5ndGggPiAwKTtcclxuICAgICAgICAgICAgdGhpcy5fdGV4dHNJZCA9IHRoaXMuYW5ub3RhdGVkVGV4dC5nZXRVbmlxdWVJZCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5fdGV4dHMgfHwgW107XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VGV4dHNGaW5hbFBvc2l0aW9ucygpOiBudW1iZXJbXSB7XHJcbiAgICAgICAgdGhpcy50ZXh0cztcclxuICAgICAgICByZXR1cm4gdGhpcy5fdGV4dHNGaW5hbFBvc2l0aW9ucztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybiB0aGUgaW5kZXggb2YgdGhlIHRleHQgcG9ydGlvbiB0aGF0IGNvbnRhaW5zIHRoZSBnaXZlbiBwb3NpdGlvbi5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gcG9zaXRpb25cclxuICAgICAqIEByZXR1cm5zIG51bWJlclxyXG4gICAgICovXHJcbiAgICBnZXRUZXh0SW5kZXhPZlBvc2l0aW9uKHBvc2l0aW9uOiBudW1iZXIpOiBudW1iZXIge1xyXG4gICAgICAgIGNvbnN0IHRleHRzRmluYWxQb3NpdGlvbnMgPSB0aGlzLmdldFRleHRzRmluYWxQb3NpdGlvbnMoKTtcclxuICAgICAgICBsZXQgbGFzdFBvc2l0aW9uID0gMDtcclxuICAgICAgICBsZXQgdGV4dEluZGV4ID0gbnVsbDtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRleHRzRmluYWxQb3NpdGlvbnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgbGV0IGVuZFBvc2l0aW9uID0gdGV4dHNGaW5hbFBvc2l0aW9uc1tpXTtcclxuICAgICAgICAgICAgaWYgKHBvc2l0aW9uID49IGxhc3RQb3NpdGlvbiAmJiBwb3NpdGlvbiA8PSBlbmRQb3NpdGlvbikge1xyXG4gICAgICAgICAgICAgICAgdGV4dEluZGV4ID0gaTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxhc3RQb3NpdGlvbiA9IGVuZFBvc2l0aW9uO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGV4dEluZGV4ID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIC8vIExpa2VseSBhbiBpbnNlcnRpb24gYXQgdGhlIGVuZCBvZiBhIHRleHRcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKFwibm8gaW5kZXggZm9yIHBvc2l0aW9uICVkXCIsIHBvc2l0aW9uKTtcclxuICAgICAgICAgICAgdGV4dEluZGV4ID0gdGV4dHNGaW5hbFBvc2l0aW9ucy5sZW5ndGggLSAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGV4dEluZGV4O1xyXG4gICAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJTZWdtZW50ZWRUZXh0IiwiQW5ub3RhdGVkVGV4dCIsIlNwbGl0VGV4dCIsImFubm90YXRlZFRleHQiLCJzcGxpdHRlciIsIl90ZXh0cyIsIl90ZXh0c0lkIiwiX3RleHRzRmluYWxQb3NpdGlvbnMiLCJnZXRVbmlxdWVJZCIsInNlZ21lbnRlZFRleHQiLCJ0ZXh0U3RyaW5nIiwiZ2V0VGV4dCIsInNwbGl0UG9zaXRpb25zIiwiZmlsdGVyIiwibCIsImxlbmd0aCIsInB1c2giLCJsYXN0UG9zaXRpb24iLCJzZWdtZW50cyIsInN0YXJ0SW5kZXgiLCJ0ZXh0cyIsImkiLCJwb3NpdGlvbiIsImVuZEluZGV4IiwiaW5kZXhPZlNlZ21lbnRBdFBvc2l0aW9uIiwidGV4dFNlZ21lbnRzIiwic2xpY2UiLCJ0ZXh0IiwiZmluYWxTZWdtZW50IiwiZW5kIiwidGV4dHNGaW5hbFBvc2l0aW9ucyIsImdldFRleHRzRmluYWxQb3NpdGlvbnMiLCJ0ZXh0SW5kZXgiLCJlbmRQb3NpdGlvbiIsImNvbnNvbGUiLCJ3YXJuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./app/lib/SplitText.js\n");

/***/ })

}]);